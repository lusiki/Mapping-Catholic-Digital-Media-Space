<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DigiKat Project">
<meta name="dcterms.date" content="2026-01-26">

<title>DigiKat Map 2: Thematic Structure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="map_2_thematic_files/libs/clipboard/clipboard.min.js"></script>
<script src="map_2_thematic_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="map_2_thematic_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="map_2_thematic_files/libs/quarto-html/popper.min.js"></script>
<script src="map_2_thematic_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="map_2_thematic_files/libs/quarto-html/anchor.min.js"></script>
<link href="map_2_thematic_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="map_2_thematic_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="map_2_thematic_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="map_2_thematic_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="map_2_thematic_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="map_2_thematic_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="map_2_thematic_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#corpus-overview" id="toc-corpus-overview" class="nav-link" data-scroll-target="#corpus-overview"><span class="header-section-number">1.1</span> Corpus Overview</a></li>
  </ul></li>
  <li><a href="#analysis-2.1-topic-discovery" id="toc-analysis-2.1-topic-discovery" class="nav-link" data-scroll-target="#analysis-2.1-topic-discovery"><span class="header-section-number">2</span> Analysis 2.1: Topic Discovery</a>
  <ul class="collapse">
  <li><a href="#topic-labels-and-top-words" id="toc-topic-labels-and-top-words" class="nav-link" data-scroll-target="#topic-labels-and-top-words"><span class="header-section-number">2.1</span> Topic Labels and Top Words</a></li>
  <li><a href="#topic-prevalence-overview" id="toc-topic-prevalence-overview" class="nav-link" data-scroll-target="#topic-prevalence-overview"><span class="header-section-number">2.2</span> Topic Prevalence Overview</a></li>
  <li><a href="#topic-word-clouds" id="toc-topic-word-clouds" class="nav-link" data-scroll-target="#topic-word-clouds"><span class="header-section-number">2.3</span> Topic Word Clouds</a></li>
  </ul></li>
  <li><a href="#analysis-2.2-topic-taxonomy" id="toc-analysis-2.2-topic-taxonomy" class="nav-link" data-scroll-target="#analysis-2.2-topic-taxonomy"><span class="header-section-number">3</span> Analysis 2.2: Topic Taxonomy</a>
  <ul class="collapse">
  <li><a href="#category-distribution" id="toc-category-distribution" class="nav-link" data-scroll-target="#category-distribution"><span class="header-section-number">3.1</span> Category Distribution</a></li>
  </ul></li>
  <li><a href="#analysis-2.3-topic-by-actor-mapping" id="toc-analysis-2.3-topic-by-actor-mapping" class="nav-link" data-scroll-target="#analysis-2.3-topic-by-actor-mapping"><span class="header-section-number">4</span> Analysis 2.3: Topic by Actor Mapping</a>
  <ul class="collapse">
  <li><a href="#topic-proportions-by-actor-type-heatmap" id="toc-topic-proportions-by-actor-type-heatmap" class="nav-link" data-scroll-target="#topic-proportions-by-actor-type-heatmap"><span class="header-section-number">4.1</span> Topic Proportions by Actor Type Heatmap</a></li>
  <li><a href="#actor-specialization-index" id="toc-actor-specialization-index" class="nav-link" data-scroll-target="#actor-specialization-index"><span class="header-section-number">4.2</span> Actor Specialization Index</a></li>
  <li><a href="#actor-type-topic-profiles" id="toc-actor-type-topic-profiles" class="nav-link" data-scroll-target="#actor-type-topic-profiles"><span class="header-section-number">4.3</span> Actor Type Topic Profiles</a></li>
  </ul></li>
  <li><a href="#analysis-2.4-topic-by-platform-mapping" id="toc-analysis-2.4-topic-by-platform-mapping" class="nav-link" data-scroll-target="#analysis-2.4-topic-by-platform-mapping"><span class="header-section-number">5</span> Analysis 2.4: Topic by Platform Mapping</a>
  <ul class="collapse">
  <li><a href="#platform-topic-heatmap" id="toc-platform-topic-heatmap" class="nav-link" data-scroll-target="#platform-topic-heatmap"><span class="header-section-number">5.1</span> Platform Topic Heatmap</a></li>
  <li><a href="#platform-category-profiles" id="toc-platform-category-profiles" class="nav-link" data-scroll-target="#platform-category-profiles"><span class="header-section-number">5.2</span> Platform Category Profiles</a></li>
  <li><a href="#platform-specialization" id="toc-platform-specialization" class="nav-link" data-scroll-target="#platform-specialization"><span class="header-section-number">5.3</span> Platform Specialization</a></li>
  </ul></li>
  <li><a href="#analysis-2.5-topic-engagement-differential" id="toc-analysis-2.5-topic-engagement-differential" class="nav-link" data-scroll-target="#analysis-2.5-topic-engagement-differential"><span class="header-section-number">6</span> Analysis 2.5: Topic Engagement Differential</a>
  <ul class="collapse">
  <li><a href="#topic-engagement-ranking" id="toc-topic-engagement-ranking" class="nav-link" data-scroll-target="#topic-engagement-ranking"><span class="header-section-number">6.1</span> Topic Engagement Ranking</a></li>
  <li><a href="#volume-vs-engagement-comparison" id="toc-volume-vs-engagement-comparison" class="nav-link" data-scroll-target="#volume-vs-engagement-comparison"><span class="header-section-number">6.2</span> Volume vs Engagement Comparison</a></li>
  <li><a href="#engagement-efficiency-by-category" id="toc-engagement-efficiency-by-category" class="nav-link" data-scroll-target="#engagement-efficiency-by-category"><span class="header-section-number">6.3</span> Engagement Efficiency by Category</a></li>
  </ul></li>
  <li><a href="#analysis-2.6-temporal-topic-trends" id="toc-analysis-2.6-temporal-topic-trends" class="nav-link" data-scroll-target="#analysis-2.6-temporal-topic-trends"><span class="header-section-number">7</span> Analysis 2.6: Temporal Topic Trends</a>
  <ul class="collapse">
  <li><a href="#top-growing-and-declining-topics" id="toc-top-growing-and-declining-topics" class="nav-link" data-scroll-target="#top-growing-and-declining-topics"><span class="header-section-number">7.1</span> Top Growing and Declining Topics</a></li>
  </ul></li>
  <li><a href="#summary-and-key-findings" id="toc-summary-and-key-findings" class="nav-link" data-scroll-target="#summary-and-key-findings"><span class="header-section-number">8</span> Summary and Key Findings</a>
  <ul class="collapse">
  <li><a href="#thematic-structure-findings" id="toc-thematic-structure-findings" class="nav-link" data-scroll-target="#thematic-structure-findings"><span class="header-section-number">8.1</span> Thematic Structure Findings</a></li>
  <li><a href="#topic-model-summary-table" id="toc-topic-model-summary-table" class="nav-link" data-scroll-target="#topic-model-summary-table"><span class="header-section-number">8.2</span> Topic Model Summary Table</a></li>
  <li><a href="#hypotheses-testing-summary" id="toc-hypotheses-testing-summary" class="nav-link" data-scroll-target="#hypotheses-testing-summary"><span class="header-section-number">8.3</span> Hypotheses Testing Summary</a></li>
  </ul></li>
  <li><a href="#appendix-model-diagnostics" id="toc-appendix-model-diagnostics" class="nav-link" data-scroll-target="#appendix-model-diagnostics"><span class="header-section-number">9</span> Appendix: Model Diagnostics</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DigiKat Map 2: Thematic Structure</h1>
<p class="subtitle lead">What is Croatian Catholic Digital Media About?</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DigiKat Project </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This document presents <strong>Map 2: Thematic Structure</strong> of the DigiKat project. The core question driving this analysis is: <strong>What is Croatian Catholic digital media about, and who specializes in what?</strong></p>
<p>We use topic modeling to discover the thematic landscape of the corpus and then examine how different actors and platforms specialize in particular topics.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Users/lsikic/Luka C/HKS/Projekti/Digitalni Kat/SHKM/DigiKat/data/merged_comprehensive.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SOURCE_TYPE <span class="sc">!=</span> <span class="st">"tiktok"</span>, <span class="sc">!</span><span class="fu">is.na</span>(SOURCE_TYPE)) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-01-01"</span>) <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-31"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2021</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2024</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(dta)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data loaded correctly</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data loaded:"</span>, <span class="fu">nrow</span>(dta), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data loaded: 372944 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(dta) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"No data after filtering! Check your date filters."</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>n_posts <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dta)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>n_with_text <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(dta<span class="sc">$</span>FULL_TEXT) <span class="sc">&amp;</span> <span class="fu">nchar</span>(dta<span class="sc">$</span>FULL_TEXT) <span class="sc">&gt;</span> <span class="dv">50</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>secular_media_exclusions <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"slobodnadalmacija"</span>, <span class="st">"vecernji"</span>, <span class="st">"index.hr"</span>, <span class="st">"jutarnji"</span>, <span class="st">"novilist"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"24sata"</span>, <span class="st">"direktno.hr"</span>, <span class="st">"nacional"</span>, <span class="st">"tportal"</span>, <span class="st">"dnevnik.hr"</span>, <span class="st">"hrt.hr"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n1info"</span>, <span class="st">"rtl.hr"</span>, <span class="st">"net.hr"</span>, <span class="st">"telegram.hr"</span>, <span class="st">"story.hr"</span>, <span class="st">"forum.hr"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"glasistre"</span>, <span class="st">"dnevno.hr"</span>, <span class="st">"prigorski"</span>, <span class="st">"glas-slavonije"</span>, <span class="st">"croativ"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oluja.info"</span>, <span class="st">"maxportal"</span>, <span class="st">"hkv.hr"</span>, <span class="st">"icv.hr"</span>, <span class="st">"novosti.hr"</span>, <span class="st">"7dnevno"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mnovine"</span>, <span class="st">"sjever.hr"</span>, <span class="st">"dulist.hr"</span>, <span class="st">"pozega.eu"</span>, <span class="st">"sibenik.in"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ferata.hr"</span>, <span class="st">"epodravina"</span>, <span class="st">"glasgacke"</span>, <span class="st">"radio-zlatar"</span>, <span class="st">"medjimurski.hr"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sbperiskop"</span>, <span class="st">"zagorje-international"</span>, <span class="st">"pozeski"</span>, <span class="st">"novine.hr"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dubrovnikinsider"</span>, <span class="st">"regionalni"</span>, <span class="st">"leportale"</span>, <span class="st">"varazdinske-vijesti"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"radionasice"</span>, <span class="st">"brodportal"</span>, <span class="st">"ljportal"</span>, <span class="st">"dubrovnikportal"</span>, <span class="st">"01portal"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tomislavnews"</span>, <span class="st">"hia.com.hr"</span>, <span class="st">"portalnovosti"</span>, <span class="st">"antenazadar"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dalmacijanews"</span>, <span class="st">"zadarskilist"</span>, <span class="st">"medjimurjepress"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"zagreb.info"</span>, <span class="st">"034portal"</span>, <span class="st">"057info"</span>, <span class="st">"inmemoriam"</span>, <span class="st">"magicus.info"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"book.hr"</span>, <span class="st">"mojzagreb.info"</span>, <span class="st">"skole.hr"</span>, <span class="st">"tvprofil"</span>, <span class="st">"cityportal"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"klikaj.hr"</span>, <span class="st">"lika-online"</span>, <span class="st">"priznajem.hr"</span>, <span class="st">"ploce.com"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dragovoljac.com"</span>, <span class="st">"sbonline"</span>, <span class="st">"narod.hr"</span>, <span class="st">"infokiosk"</span>, <span class="st">"hrsvijet"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tomislavcity"</span>, <span class="st">"vrisak.info"</span>, <span class="st">"croatia"</span>, <span class="st">"anonymous_user"</span>, <span class="st">"reddit"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dalmacijadanas"</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>classify_actor_v2 <span class="ot">&lt;-</span> <span class="cf">function</span>(from_value, <span class="at">url_value =</span> <span class="cn">NA</span>) {</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  from_lower <span class="ot">&lt;-</span> <span class="fu">tolower</span>(from_value)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  url_lower <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(url_value), <span class="st">""</span>, url_value))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(secular_media_exclusions, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  institutional_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hkm.hr"</span>, <span class="st">"ika.hkm.hr"</span>, <span class="st">"hkr.hkm.hr"</span>, <span class="st">"hbk.hr"</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(institutional_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Institutional Official"</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  institutional_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatska katolička mreža"</span>, <span class="st">"katolička mreža"</span>, <span class="st">"hkm"</span>, </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"informativna katolička agencija"</span>, <span class="st">"ika"</span>, <span class="st">"hrvatski katolički radio"</span>, <span class="st">"hkr"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatska biskupska konferencija"</span>, <span class="st">"hbk"</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(institutional_names, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Institutional Official"</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  diocesan_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zg-nadbiskupija.hr"</span>, <span class="st">"biskupija-varazdinska.hr"</span>, <span class="st">"djos.hr"</span>, </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"biskupija-sj.hr"</span>, <span class="st">"rzs.hr"</span>, <span class="st">"rkc-sisak.hr"</span>, <span class="st">"zadarskanadbiskupija.hr"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gospicko-senjska-biskupija.hr"</span>, <span class="st">"nadbiskupija-split.com"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dubrovacka-biskupija.hr"</span>, <span class="st">"porec-biskupija.hr"</span>, <span class="st">"biskupija-kk.hr"</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(diocesan_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Diocesan"</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  diocesan_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nadbiskupija"</span>, <span class="st">"biskupija"</span>, <span class="st">"župa "</span>, <span class="st">"zupa "</span>, </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zagrebačka nadbiskupija"</span>, <span class="st">"splitsko-makarska"</span>, <span class="st">"đakovačko-osječka"</span>,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"riječka nadbiskupija"</span>, <span class="st">"zadarska nadbiskupija"</span>, <span class="st">"sisačka biskupija"</span>,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"varaždinska biskupija"</span>, <span class="st">"križevačka eparhija"</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(diocesan_names, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Diocesan"</span>)</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  independent_media_exact <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"laudatotv"</span>, <span class="st">"laudato tv"</span>, <span class="st">"laudato.tv"</span>, <span class="st">"laudato.hr"</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bitno.net"</span>, <span class="st">"bitno net"</span>, <span class="st">"glas koncila"</span>, <span class="st">"glaskoncila.hr"</span>,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nova-eva.com"</span>, <span class="st">"nova eva"</span>, <span class="st">"katolički tjednik"</span>, <span class="st">"katolicki tjednik"</span>,</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kršćanska sadašnjost"</span>, <span class="st">"ks.hr"</span>, <span class="st">"verbum.hr"</span>, <span class="st">"verbum"</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mir i dobro"</span>, <span class="st">"gfranciskovic"</span>, <span class="st">"kfranciskovic"</span>, <span class="st">"totus tuus"</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(independent_media_exact, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Independent Media"</span>)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  independent_media_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"laudato.hr"</span>, <span class="st">"laudato.tv"</span>, <span class="st">"bitno.net"</span>, <span class="st">"glaskoncila.hr"</span>, </span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nova-eva.com"</span>, <span class="st">"verbum.hr"</span>, <span class="st">"ks.hr"</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(independent_media_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Independent Media"</span>)</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  religious_orders_exact <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"franjevci"</span>, <span class="st">"franjevački"</span>, <span class="st">"franjevacki"</span>, <span class="st">"ofm"</span>,</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"isusovci"</span>, <span class="st">"družba isusova"</span>, <span class="st">"druzba isusova"</span>, <span class="st">"sj"</span>,</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dominikanci"</span>, <span class="st">"dominikanski"</span>, <span class="st">"op"</span>,</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"salezijanci"</span>, <span class="st">"salezijanski"</span>, <span class="st">"sdb"</span>,</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"karmelićani"</span>, <span class="st">"karmelicani"</span>, <span class="st">"karmel"</span>,</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">"benediktinci"</span>, <span class="st">"benediktinski"</span>, <span class="st">"osb"</span>,</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kapucini"</span>, <span class="st">"kapucinski"</span>, <span class="st">"ofmcap"</span>,</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pavlini"</span>, <span class="st">"pavlinski"</span>,</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trapisti"</span>, <span class="st">"cisterciti"</span>,</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sestre milosrdnice"</span>, <span class="st">"uršulinke"</span>, <span class="st">"klarise"</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(religious_orders_exact, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Religious Orders"</span>)</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>  charismatic_exact <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"božja pobjeda"</span>, <span class="st">"bozja pobjeda"</span>, <span class="st">"bozjapobjeda"</span>,</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"srce isusovo"</span>, <span class="st">"srceisuovo"</span>, <span class="st">"srceisusovo"</span>,</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"muževni budite"</span>, <span class="st">"muzevni budite"</span>, <span class="st">"muzevnibudite"</span>,</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"molitvena zajednica"</span>, <span class="st">"karizmatska"</span>, <span class="st">"cenacolo"</span>,</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"emmanuel community"</span>, <span class="st">"emmanuel zajednica"</span>, <span class="st">"taize"</span>,</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neokatekumenski"</span>, <span class="st">"neokatekumenska"</span>, <span class="st">"kursiljo"</span>,</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fokolari"</span>, <span class="st">"fokolarini"</span>, <span class="st">"komunija i oslobođenje"</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(charismatic_exact, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Charismatic Communities"</span>)</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>  priest_patterns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fra "</span>, <span class="st">"don "</span>, <span class="st">"vlč."</span>, <span class="st">"vlc."</span>, <span class="st">"msgr."</span>, <span class="st">"mons."</span>,</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"padre "</span>, <span class="st">"o. "</span>, <span class="st">"pater "</span>, <span class="st">"biskup "</span>, <span class="st">"nadbiskup "</span>,</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kardinal "</span>, <span class="st">"svećenik"</span>, <span class="st">"svecenik"</span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(priest_patterns, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Individual Priests"</span>)</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>  youth_exact <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"frama"</span>, <span class="st">"shkm"</span>, <span class="st">"katolička mladež"</span>, <span class="st">"katolicka mladez"</span>,</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ministranti"</span>, <span class="st">"mladifra"</span>, <span class="st">"mladi fra"</span>, <span class="st">"kaem"</span>, <span class="st">"kud"</span>,</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sveučilišna kapelanija"</span>, <span class="st">"studentska kapelanija"</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(youth_exact, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Youth Organizations"</span>)</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  academic_exact <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">"unicath"</span>, <span class="st">"katolički bogoslovni fakultet"</span>, <span class="st">"kbf"</span>,</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"teologija"</span>, <span class="st">"filozofski fakultet družbe isusove"</span>, <span class="st">"hks.hr"</span>,</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatsko katoličko sveučilište"</span>, <span class="st">"hku"</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(academic_exact, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Academic"</span>)</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  lay_influencer_patterns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"vjera"</span>, <span class="st">"molitva"</span>, <span class="st">"isus"</span>, <span class="st">"krist"</span>, <span class="st">"gospa"</span>, <span class="st">"marija"</span>,</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrana za dušu"</span>, <span class="st">"hrana za dusu"</span>, <span class="st">"dijete vjere"</span>,</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pulherissimus"</span>, <span class="st">"riječ"</span>, <span class="st">"rijec"</span>, <span class="st">"katolik"</span>,</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kršćan"</span>, <span class="st">"krscan"</span>, <span class="st">"evanđelje"</span>, <span class="st">"evandelje"</span>,</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"duhovn"</span>, <span class="st">"svetac"</span>, <span class="st">"sveci"</span>, <span class="st">"biblij"</span>, <span class="st">"psalm"</span>,</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"blagoslov"</span>, <span class="st">"nebo"</span>, <span class="st">"spasenje"</span>, <span class="st">"uskrs"</span>, <span class="st">"božić"</span>, <span class="st">"bozic"</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>  is_social_media <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"facebook</span><span class="sc">\\</span><span class="st">.com|youtube</span><span class="sc">\\</span><span class="st">.com|instagram</span><span class="sc">\\</span><span class="st">.com"</span>, url_lower) <span class="sc">|</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, from_lower)</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (is_social_media <span class="sc">&amp;&amp;</span> <span class="fu">any</span>(<span class="fu">sapply</span>(lay_influencer_patterns, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Lay Influencers"</span>)</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>dta[, ACTOR_TYPE <span class="sc">:</span><span class="er">=</span> <span class="fu">mapply</span>(classify_actor_v2, FROM, URL)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="corpus-overview" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="corpus-overview"><span class="header-section-number">1.1</span> Corpus Overview</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Total posts"</span>, <span class="st">"Posts with sufficient text (&gt;50 chars)"</span>, <span class="st">"Unique sources"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Date range"</span>, <span class="st">"Platforms"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(n_posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(n_with_text, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">uniqueN</span>(dta<span class="sc">$</span>FROM), <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">min</span>(dta<span class="sc">$</span>DATE), <span class="st">"to"</span>, <span class="fu">max</span>(dta<span class="sc">$</span>DATE)),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">unique</span>(dta<span class="sc">$</span>SOURCE_TYPE), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total posts</td>
<td style="text-align: left;">372,944</td>
</tr>
<tr class="even">
<td style="text-align: left;">Posts with sufficient text (&gt;50 chars)</td>
<td style="text-align: left;">372,614</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unique sources</td>
<td style="text-align: left;">9,896</td>
</tr>
<tr class="even">
<td style="text-align: left;">Date range</td>
<td style="text-align: left;">2021-01-01 to 2024-12-31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Platforms</td>
<td style="text-align: left;">web, facebook, twitter, comment, youtube, forum, reddit, instagram</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="analysis-2.1-topic-discovery" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Analysis 2.1: Topic Discovery</h1>
<p>We use Structural Topic Modeling (STM) which allows incorporating document metadata as covariates. The analysis uses Croatian text preprocessing with custom stopwords.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>croatian_stopwords <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- CONJUNCTIONS (Veznici) ---</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"i"</span>, <span class="st">"pa"</span>, <span class="st">"te"</span>, <span class="st">"ni"</span>, <span class="st">"niti"</span>, <span class="st">"a"</span>, <span class="st">"ali"</span>, <span class="st">"nego"</span>, <span class="st">"no"</span>, <span class="st">"već"</span>, <span class="st">"vec"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ili"</span>, <span class="st">"da"</span>, <span class="st">"dok"</span>, <span class="st">"jer"</span>, <span class="st">"ako"</span>, <span class="st">"mada"</span>, <span class="st">"premda"</span>, <span class="st">"iako"</span>, <span class="st">"kako"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"neka"</span>, <span class="st">"kad"</span>, <span class="st">"kada"</span>, <span class="st">"cim"</span>, <span class="st">"čim"</span>, <span class="st">"zato"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- PREPOSITIONS (Prijedlozi) ---</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"u"</span>, <span class="st">"na"</span>, <span class="st">"s"</span>, <span class="st">"sa"</span>, <span class="st">"o"</span>, <span class="st">"po"</span>, <span class="st">"za"</span>, <span class="st">"uz"</span>, <span class="st">"iz"</span>, <span class="st">"do"</span>, <span class="st">"od"</span>, <span class="st">"pri"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"k"</span>, <span class="st">"ka"</span>, <span class="st">"bez"</span>, <span class="st">"blizu"</span>, <span class="st">"osim"</span>, <span class="st">"među"</span>, <span class="st">"medju"</span>, <span class="st">"poput"</span>, <span class="st">"putem"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"prema"</span>, <span class="st">"pored"</span>, <span class="st">"pokraj"</span>, <span class="st">"kroz"</span>, <span class="st">"nad"</span>, <span class="st">"pod"</span>, <span class="st">"pred"</span>, <span class="st">"oko"</span>, <span class="st">"okolo"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"niz"</span>, <span class="st">"uzduž"</span>, <span class="st">"duž"</span>, <span class="st">"vrh"</span>, <span class="st">"dno"</span>, <span class="st">"kraj"</span>, <span class="st">"krajem"</span>, <span class="st">"usprkos"</span>, <span class="st">"glede"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nasuprot"</span>, <span class="st">"ispod"</span>, <span class="st">"iznad"</span>, <span class="st">"između"</span>, <span class="st">"izmedju"</span>, <span class="st">"iza"</span>, <span class="st">"unutar"</span>, <span class="st">"van"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- AUXILIARY VERBS &amp; "BITI" (To Be) ---</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Present</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sam"</span>, <span class="st">"si"</span>, <span class="st">"je"</span>, <span class="st">"smo"</span>, <span class="st">"ste"</span>, <span class="st">"su"</span>, <span class="st">"jesam"</span>, <span class="st">"jesi"</span>, <span class="st">"jest"</span>, <span class="st">"jesmo"</span>, <span class="st">"jeste"</span>, <span class="st">"jesu"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"budem"</span>, <span class="st">"budeš"</span>, <span class="st">"budes"</span>, <span class="st">"bude"</span>, <span class="st">"budemo"</span>, <span class="st">"budete"</span>, <span class="st">"budu"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Past</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bio"</span>, <span class="st">"bila"</span>, <span class="st">"bilo"</span>, <span class="st">"bili"</span>, <span class="st">"bile"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Negative</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nisam"</span>, <span class="st">"nisi"</span>, <span class="st">"nije"</span>, <span class="st">"nismo"</span>, <span class="st">"niste"</span>, <span class="st">"nisu"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ne"</span>, <span class="st">"nemoj"</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Infinitive</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"biti"</span>, <span class="st">"bit"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- VERBS "HTJETI" (Will/Want) ---</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ću"</span>, <span class="st">"cu"</span>, <span class="st">"ćeš"</span>, <span class="st">"ces"</span>, <span class="st">"će"</span>, <span class="st">"ce"</span>, <span class="st">"ćemo"</span>, <span class="st">"cemo"</span>, <span class="st">"ćete"</span>, <span class="st">"cete"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hoću"</span>, <span class="st">"hocu"</span>, <span class="st">"hoćeš"</span>, <span class="st">"hoces"</span>, <span class="st">"hoće"</span>, <span class="st">"hoce"</span>, <span class="st">"hoćemo"</span>, <span class="st">"hocemo"</span>, <span class="st">"hoćete"</span>, <span class="st">"hocete"</span>, <span class="st">"hoće"</span>, <span class="st">"hoce"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bih"</span>, <span class="st">"bi"</span>, <span class="st">"bismo"</span>, <span class="st">"biste"</span>, <span class="st">"htio"</span>, <span class="st">"htjela"</span>, <span class="st">"htjelo"</span>, <span class="st">"htjeli"</span>, <span class="st">"htjele"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"neću"</span>, <span class="st">"necu"</span>, <span class="st">"nećeš"</span>, <span class="st">"neces"</span>, <span class="st">"neće"</span>, <span class="st">"nece"</span>, <span class="st">"nećemo"</span>, <span class="st">"necemo"</span>, <span class="st">"nećete"</span>, <span class="st">"necete"</span>, <span class="st">"neće"</span>, <span class="st">"nece"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- VERBS "MOĆI" &amp; "IMATI" (Can/Have) ---</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mogu"</span>, <span class="st">"možeš"</span>, <span class="st">"mozes"</span>, <span class="st">"može"</span>, <span class="st">"moze"</span>, <span class="st">"možemo"</span>, <span class="st">"mozemo"</span>, <span class="st">"možete"</span>, <span class="st">"mozete"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mogao"</span>, <span class="st">"mogla"</span>, <span class="st">"moglo"</span>, <span class="st">"mogli"</span>, <span class="st">"mogle"</span>, <span class="st">"moći"</span>, <span class="st">"moci"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"imam"</span>, <span class="st">"imaš"</span>, <span class="st">"imas"</span>, <span class="st">"ima"</span>, <span class="st">"imamo"</span>, <span class="st">"imate"</span>, <span class="st">"imaju"</span>, <span class="st">"imao"</span>, <span class="st">"imala"</span>, <span class="st">"imalo"</span>, <span class="st">"imali"</span>, <span class="st">"imati"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- PRONOUNS: 1st Person (Ja, Mi) - All Cases ---</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ja"</span>, <span class="st">"mene"</span>, <span class="st">"meni"</span>, <span class="st">"me"</span>, <span class="st">"mnom"</span>, <span class="st">"mnome"</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mi"</span>, <span class="st">"nas"</span>, <span class="st">"nama"</span>, <span class="st">"nam"</span>, <span class="st">"nama"</span>,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- PRONOUNS: 2nd Person (Ti, Vi) - All Cases ---</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ti"</span>, <span class="st">"tebe"</span>, <span class="st">"tebi"</span>, <span class="st">"te"</span>, <span class="st">"tobom"</span>, <span class="st">"tobome"</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vi"</span>, <span class="st">"vas"</span>, <span class="st">"vama"</span>, <span class="st">"vam"</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- PRONOUNS: 3rd Person (On, Ona, Ono, Oni) - All Cases ---</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"on"</span>, <span class="st">"njega"</span>, <span class="st">"njemu"</span>, <span class="st">"ga"</span>, <span class="st">"nj"</span>, <span class="st">"njim"</span>, <span class="st">"njime"</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ona"</span>, <span class="st">"nje"</span>, <span class="st">"njoj"</span>, <span class="st">"ju"</span>, <span class="st">"je"</span>, <span class="st">"njom"</span>, <span class="st">"njome"</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ono"</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oni"</span>, <span class="st">"one"</span>, <span class="st">"ona"</span>, <span class="st">"njih"</span>, <span class="st">"njima"</span>, <span class="st">"ih"</span>,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- PRONOUNS: Reflexive (Sebe) ---</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sebe"</span>, <span class="st">"sebi"</span>, <span class="st">"se"</span>, <span class="st">"sobom"</span>,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- DETERMINERS &amp; POSSESSIVES (This, That, My, Your...) ---</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only high frequency variations included to prevent list bloat</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"taj"</span>, <span class="st">"ta"</span>, <span class="st">"to"</span>, <span class="st">"tog"</span>, <span class="st">"toga"</span>, <span class="st">"tom"</span>, <span class="st">"tome"</span>, <span class="st">"tomu"</span>, <span class="st">"tim"</span>, <span class="st">"tima"</span>, <span class="st">"toj"</span>, <span class="st">"te"</span>,</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ovaj"</span>, <span class="st">"ova"</span>, <span class="st">"ovo"</span>, <span class="st">"ovog"</span>, <span class="st">"ovoga"</span>, <span class="st">"ovom"</span>, <span class="st">"ovome"</span>, <span class="st">"ovim"</span>, <span class="st">"ovima"</span>, <span class="st">"ovoj"</span>, <span class="st">"ove"</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="st">"onaj"</span>, <span class="st">"ona"</span>, <span class="st">"ono"</span>, <span class="st">"onog"</span>, <span class="st">"onoga"</span>, <span class="st">"onom"</span>, <span class="st">"onome"</span>, <span class="st">"onim"</span>, <span class="st">"onima"</span>, <span class="st">"onoj"</span>, <span class="st">"one"</span>,</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">"moj"</span>, <span class="st">"moja"</span>, <span class="st">"moje"</span>, <span class="st">"mojeg"</span>, <span class="st">"mojega"</span>, <span class="st">"mom"</span>, <span class="st">"mome"</span>, <span class="st">"mojem"</span>, <span class="st">"mojemu"</span>, <span class="st">"mojim"</span>, <span class="st">"mojima"</span>, <span class="st">"mojih"</span>,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tvoj"</span>, <span class="st">"tvoja"</span>, <span class="st">"tvoje"</span>, <span class="st">"tvojeg"</span>, <span class="st">"tvojim"</span>,</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">"naš"</span>, <span class="st">"nas"</span>, <span class="st">"naša"</span>, <span class="st">"nasa"</span>, <span class="st">"naše"</span>, <span class="st">"nase"</span>, <span class="st">"našeg"</span>, <span class="st">"naseg"</span>, <span class="st">"našem"</span>, <span class="st">"nasem"</span>, <span class="st">"našim"</span>, <span class="st">"nasim"</span>,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vaš"</span>, <span class="st">"vas"</span>, <span class="st">"vaša"</span>, <span class="st">"vasa"</span>, <span class="st">"vaše"</span>, <span class="st">"vase"</span>, <span class="st">"vašeg"</span>, <span class="st">"vaseg"</span>, <span class="st">"vašem"</span>, <span class="st">"vasem"</span>, <span class="st">"vašim"</span>, <span class="st">"vasim"</span>,</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="st">"njegov"</span>, <span class="st">"njegova"</span>, <span class="st">"njegovo"</span>, <span class="st">"njen"</span>, <span class="st">"njezin"</span>, <span class="st">"njihov"</span>, <span class="st">"njihova"</span>, <span class="st">"njihovo"</span>,</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- RELATIVE PRONOUNS / QUESTION WORDS ---</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tko"</span>, <span class="st">"što"</span>, <span class="st">"sto"</span>, <span class="st">"kog"</span>, <span class="st">"koga"</span>, <span class="st">"kom"</span>, <span class="st">"kome"</span>, <span class="st">"čemu"</span>, <span class="st">"cemu"</span>, <span class="st">"čim"</span>, <span class="st">"cim"</span>, <span class="st">"čime"</span>, <span class="st">"cime"</span>,</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="st">"koji"</span>, <span class="st">"koja"</span>, <span class="st">"koje"</span>, <span class="st">"kojeg"</span>, <span class="st">"kojega"</span>, <span class="st">"kojem"</span>, <span class="st">"kojemu"</span>, <span class="st">"kojim"</span>, <span class="st">"kojima"</span>, <span class="st">"kojih"</span>,</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kakav"</span>, <span class="st">"kakva"</span>, <span class="st">"kakvo"</span>, <span class="st">"svaki"</span>, <span class="st">"svaka"</span>, <span class="st">"svako"</span>, <span class="st">"sva"</span>, <span class="st">"sve"</span>, <span class="st">"svi"</span>, <span class="st">"svih"</span>, <span class="st">"svima"</span>,</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  <span class="st">"neki"</span>, <span class="st">"neka"</span>, <span class="st">"neko"</span>, <span class="st">"nekog"</span>, <span class="st">"nekom"</span>, <span class="st">"nekim"</span>,</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sav"</span>, <span class="st">"sva"</span>, <span class="st">"sve"</span>,</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">"netko"</span>, <span class="st">"nešto"</span>, <span class="st">"nesto"</span>, <span class="st">"nitko"</span>, <span class="st">"ništa"</span>, <span class="st">"nista"</span>, <span class="st">"svatko"</span>,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- ADVERBS &amp; PARTICLES (Prilozi i čestice) ---</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gdje"</span>, <span class="st">"kamo"</span>, <span class="st">"kuda"</span>, <span class="st">"odakle"</span>, <span class="st">"kako"</span>, <span class="st">"zašto"</span>, <span class="st">"zasto"</span>,</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ovdje"</span>, <span class="st">"tamo"</span>, <span class="st">"tu"</span>, <span class="st">"negdje"</span>, <span class="st">"nigdje"</span>,</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jučer"</span>, <span class="st">"jucer"</span>, <span class="st">"danas"</span>, <span class="st">"sutra"</span>, <span class="st">"sada"</span>, <span class="st">"sad"</span>, <span class="st">"tada"</span>, <span class="st">"onda"</span>, <span class="st">"uvijek"</span>, <span class="st">"nikad"</span>, <span class="st">"nikada"</span>,</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mnogo"</span>, <span class="st">"puno"</span>, <span class="st">"malo"</span>, <span class="st">"više"</span>, <span class="st">"vise"</span>, <span class="st">"manje"</span>,</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jako"</span>, <span class="st">"vrlo"</span>, <span class="st">"baš"</span>, <span class="st">"bas"</span>, <span class="st">"čak"</span>, <span class="st">"cak"</span>,</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dakle"</span>, <span class="st">"međutim"</span>, <span class="st">"medjutim"</span>, <span class="st">"naprosto"</span>, <span class="st">"naime"</span>, <span class="st">"vjerojatno"</span>, <span class="st">"naravno"</span>, <span class="st">"sigurno"</span>, <span class="st">"zaista"</span>, <span class="st">"doista"</span>,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- NUMBERS (Common in text) ---</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jedan"</span>, <span class="st">"jedna"</span>, <span class="st">"jedno"</span>, <span class="st">"dva"</span>, <span class="st">"tri"</span>, <span class="st">"četiri"</span>, <span class="st">"cetiri"</span>, <span class="st">"pet"</span>, <span class="st">"šest"</span>, <span class="st">"sest"</span>, <span class="st">"sedam"</span>, <span class="st">"osam"</span>, <span class="st">"devet"</span>, <span class="st">"deset"</span>,</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">"prvi"</span>, <span class="st">"prva"</span>, <span class="st">"prvo"</span>, <span class="st">"drugi"</span>, <span class="st">"druga"</span>, <span class="st">"drugo"</span>, <span class="st">"treći"</span>, <span class="st">"treci"</span>,</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- TECH / WEB NOISE ---</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>  <span class="st">"http"</span>, <span class="st">"https"</span>, <span class="st">"www"</span>, <span class="st">"com"</span>, <span class="st">"hr"</span>, <span class="st">"org"</span>, <span class="st">"net"</span>, <span class="st">"foto"</span>, <span class="st">"video"</span>, <span class="st">"slika"</span>, <span class="st">"clanak"</span>, <span class="st">"članak"</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>dta_text <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(FULL_TEXT) <span class="sc">&amp;</span> <span class="fu">nchar</span>(FULL_TEXT) <span class="sc">&gt;</span> <span class="dv">100</span>]</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Use SAMPLE_PCT from config (set at top of file)</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">nrow</span>(dta_text) <span class="sc">*</span> SAMPLE_PCT)</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>sample_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dta_text), sample_size)</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>dta_sample <span class="ot">&lt;-</span> dta_text[sample_idx]</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="st">╔══════════════════════════════════════════════════════════════════╗</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="st">║  SAMPLING CONFIGURATION                                          ║</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="st">╠══════════════════════════════════════════════════════════════════╣</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a><span class="st">║  Sample percentage:"</span>, <span class="fu">sprintf</span>(<span class="st">"%5.1f%%"</span>, SAMPLE_PCT <span class="sc">*</span> <span class="dv">100</span>), <span class="st">"</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="st">║  Documents sampled:"</span>, <span class="fu">sprintf</span>(<span class="st">"%6d"</span>, <span class="fu">nrow</span>(dta_sample)), <span class="st">"</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="st">║  Total available:  "</span>, <span class="fu">sprintf</span>(<span class="st">"%6d"</span>, <span class="fu">nrow</span>(dta_text)), <span class="st">"</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="st">╚══════════════════════════════════════════════════════════════════╝</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
╔══════════════════════════════════════════════════════════════════╗
║  SAMPLING CONFIGURATION                                          ║
╠══════════════════════════════════════════════════════════════════╣
║  Sample percentage:   1.0% 
║  Documents sampled:   3712 
║  Total available:   371119 
╚══════════════════════════════════════════════════════════════════╝</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dta_sample[, doc_id <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> FULL_TEXT]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">"https?://</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">""</span>, clean_text)]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">"www</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">S+"</span>, <span class="st">""</span>, clean_text)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">"[^[:alpha:][:space:]]"</span>, <span class="st">" "</span>, clean_text)]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">tolower</span>(clean_text)]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>, clean_text)]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>dta_sample[, clean_text <span class="sc">:</span><span class="er">=</span> <span class="fu">trimws</span>(clean_text)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>corpus_cath <span class="ot">&lt;-</span> <span class="fu">corpus</span>(dta_sample, <span class="at">text_field =</span> <span class="st">"clean_text"</span>, <span class="at">docid_field =</span> <span class="st">"doc_id"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(corpus_cath, <span class="st">"actor_type"</span>) <span class="ot">&lt;-</span> dta_sample<span class="sc">$</span>ACTOR_TYPE</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(corpus_cath, <span class="st">"platform"</span>) <span class="ot">&lt;-</span> dta_sample<span class="sc">$</span>SOURCE_TYPE</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(corpus_cath, <span class="st">"year"</span>) <span class="ot">&lt;-</span> dta_sample<span class="sc">$</span>year</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>tokens_cath <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corpus_cath, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern =</span> croatian_stopwords) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(<span class="at">pattern =</span> <span class="fu">stopwords</span>(<span class="st">"en"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_keep</span>(<span class="at">min_nchar =</span> <span class="dv">3</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>dfm_cath <span class="ot">&lt;-</span> <span class="fu">dfm</span>(tokens_cath) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">min_docfreq =</span> <span class="dv">5</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Documents:"</span>, <span class="fu">ndoc</span>(dfm_cath), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Documents: 3712 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Features:"</span>, <span class="fu">nfeat</span>(dfm_cath), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Features: 21041 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Safety checks before running STM</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">ndoc</span>(dfm_cath) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"DFM has 0 documents! Check your data loading and filtering steps."</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nfeat</span>(dfm_cath) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"DFM has 0 features! Check your text preprocessing and trimming parameters."</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">ndoc</span>(dfm_cath) <span class="sc">&lt;</span> <span class="dv">100</span>) {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Very few documents ("</span>, <span class="fu">ndoc</span>(dfm_cath), <span class="st">"). Results may be unreliable."</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>stm_dfm <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfm_cath, <span class="at">to =</span> <span class="st">"stm"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify conversion worked</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(stm_dfm<span class="sc">$</span>documents) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"STM conversion resulted in 0 documents!"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Use NUM_TOPICS from config (set at top of file)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> NUM_TOPICS</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust K if we have too few documents</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(stm_dfm<span class="sc">$</span>documents) <span class="sc">&lt;</span> K <span class="sc">*</span> <span class="dv">3</span>) {</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">5</span>, <span class="fu">floor</span>(<span class="fu">length</span>(stm_dfm<span class="sc">$</span>documents) <span class="sc">/</span> <span class="dv">3</span>))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Reduced K to "</span>, K, <span class="st">" due to small corpus size"</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>stm_model <span class="ot">&lt;-</span> <span class="fu">stm</span>(</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">documents =</span> stm_dfm<span class="sc">$</span>documents,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocab =</span> stm_dfm<span class="sc">$</span>vocab,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> K,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">prevalence =</span> <span class="sc">~</span> actor_type <span class="sc">+</span> platform,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stm_dfm<span class="sc">$</span>meta,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.type =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.em.its =</span> <span class="dv">50</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Beginning Spectral Initialization 
     Calculating the gram matrix...
     Using only 10000 most frequent terms during initialization...
     Finding anchor words...
    ...................................
     Recovering initialization...
    ....................................................................................................
Initialization complete.
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 1 (approx. per word bound = -9.689) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 2 (approx. per word bound = -8.469, relative change = 1.260e-01) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 3 (approx. per word bound = -8.351, relative change = 1.392e-02) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 4 (approx. per word bound = -8.317, relative change = 4.011e-03) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 5 (approx. per word bound = -8.300, relative change = 2.103e-03) 
Topic 1: crkvu, klanjanje, molimo, presvetim, euharistijskog 
 Topic 2: godine, grada, škole, kao, ana 
 Topic 3: zagreb, grada, prijave, putovanja, rok 
 Topic 4: sati, gospe, blagdan, misa, blagoslov 
 Topic 5: kao, cropix, nakon, rekla, godina 
 Topic 6: kao, godine, kod, kbr, ulica 
 Topic 7: godine, afp, nakon, još, zbog 
 Topic 8: papa, web, franjo, film, rekao 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, kao, sadrži, samo, oil 
 Topic 11: sestre, kao, sestara, molitve, života 
 Topic 12: naslov, article, cookie, category, postovi 
 Topic 13: svećenika, kao, biskupije, godine, biskup 
 Topic 14: kao, tako, nakon, još, samo 
 Topic 15: kao, isusa, isus, bog, crkva 
 Topic 16: fra, godine, župe, kao, vlč 
 Topic 17: kao, godine, nakon, bog, još 
 Topic 18: kao, nema, samo, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, kao 
 Topic 20: kao, samo, tako, hdz, još 
 Topic 21: biskup, hrvatske, predsjednik, hrvatskih, kao 
 Topic 22: laudato, kao, crkve, crkva, spc 
 Topic 23: crkve, papa, godine, kao, franjo 
 Topic 24: kao, ljudi, samo, tako, zbog 
 Topic 25: kao, hvala, godine, godina, molim 
 Topic 26: bog, kao, isus, boga, život 
 Topic 27: kao, godine, projekta, projekt, području 
 Topic 28: josipa, godine, svetog, kao, godina 
 Topic 29: godine, kao, nakon, ostala, godina 
 Topic 30: kao, hrvatske, godine, hrvatska, hrvatskoj 
 Topic 31: sati, godine, dana, dan, hrvatske 
 Topic 32: kao, samo, treba, tako, svoje 
 Topic 33: godine, županije, papa, kao, franjo 
 Topic 34: kao, nakon, godine, protiv, zbog 
 Topic 35: nuncij, antuna, lingua, padovanskog, potresu 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 6 (approx. per word bound = -8.289, relative change = 1.330e-03) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 7 (approx. per word bound = -8.281, relative change = 9.675e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 8 (approx. per word bound = -8.274, relative change = 7.543e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 9 (approx. per word bound = -8.269, relative change = 6.156e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 10 (approx. per word bound = -8.265, relative change = 5.236e-04) 
Topic 1: crkvu, klanjanje, molimo, presvetim, srca 
 Topic 2: godine, grada, škole, škola, kao 
 Topic 3: grada, zagreb, prijave, putovanja, ulica 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, zagrebu, umjetnosti 
 Topic 7: godine, afp, još, nakon, kao 
 Topic 8: papa, web, franjo, film, rekao 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, kao, sadrži, tablete, samo 
 Topic 11: sestre, kao, sestara, molitve, života 
 Topic 12: naslov, article, cookie, postovi, category 
 Topic 13: svećenika, biskupije, godine, svećenik, kao 
 Topic 14: kao, tako, još, nakon, samo 
 Topic 15: kao, isusa, isus, bog, krista 
 Topic 16: fra, župe, vlč, godine, župi 
 Topic 17: kao, godine, nakon, bog, još 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, đakovačko 
 Topic 20: kao, samo, hdz, tako, još 
 Topic 21: hrvatske, predsjednik, biskup, hrvatskog, caritasa 
 Topic 22: laudato, kao, crkve, crkva, pravoslavne 
 Topic 23: papa, crkve, franjo, kao, godine 
 Topic 24: kao, ljudi, samo, tako, zbog 
 Topic 25: kao, godine, godina, hvala, molim 
 Topic 26: bog, kao, isus, boga, život 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: josipa, godine, svetog, kao, nakon 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, hrvatske, godine, hrvatska, hrvatskoj 
 Topic 31: sati, dan, dana, godine, spomen 
 Topic 32: kao, samo, treba, tako, svoje 
 Topic 33: županije, godine, kao, grada, papa 
 Topic 34: kao, nakon, godine, protiv, zbog 
 Topic 35: antuna, košić, nuncij, potresu, crkvi 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 11 (approx. per word bound = -8.261, relative change = 4.555e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 12 (approx. per word bound = -8.258, relative change = 3.963e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 13 (approx. per word bound = -8.255, relative change = 3.440e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 14 (approx. per word bound = -8.253, relative change = 3.079e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 15 (approx. per word bound = -8.250, relative change = 2.789e-04) 
Topic 1: crkvu, klanjanje, presvetim, preminuo, molimo 
 Topic 2: godine, grada, škole, škola, hrvatske 
 Topic 3: grada, putovanja, prijave, ulica, zagreb 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, koncert, zagrebu 
 Topic 7: godine, afp, nakon, još, kao 
 Topic 8: papa, web, franjo, film, kolačića 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, kilograma 
 Topic 11: sestre, kao, obitelji, život, života 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, godine, kao, crkve 
 Topic 14: kao, tako, još, nakon, samo 
 Topic 15: kao, isusa, isus, bog, krista 
 Topic 16: fra, župe, vlč, župi, godine 
 Topic 17: kao, godine, nakon, bog, još 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, đakovačko 
 Topic 20: kao, samo, hdz, tako, još 
 Topic 21: hrvatske, predsjednik, biskup, hrvatskog, caritasa 
 Topic 22: laudato, kao, crkve, crkva, pravoslavne 
 Topic 23: papa, franjo, crkve, kao, godine 
 Topic 24: kao, ljudi, samo, tako, zbog 
 Topic 25: kao, godina, godine, hvala, molim 
 Topic 26: bog, isus, kao, boga, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: josipa, godine, svetog, kao, crkve 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, hrvatske, godine, hrvatska, hrvatski 
 Topic 31: dan, dana, branitelja, sati, spomen 
 Topic 32: kao, samo, tako, treba, svoje 
 Topic 33: županije, godine, grada, općine, kao 
 Topic 34: kao, nakon, protiv, zbog, godine 
 Topic 35: antuna, košić, sisačke, biskup, potresu 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 16 (approx. per word bound = -8.248, relative change = 2.441e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 17 (approx. per word bound = -8.246, relative change = 2.223e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 18 (approx. per word bound = -8.245, relative change = 2.017e-04) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 19 (approx. per word bound = -8.243, relative change = 1.945e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 20 (approx. per word bound = -8.242, relative change = 1.640e-04) 
Topic 1: crkvu, klanjanje, preminuo, godini, crkvi 
 Topic 2: godine, grada, škole, škola, hrvatske 
 Topic 3: grada, putovanja, ulica, prijave, grad 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, koncert, umjetnosti 
 Topic 7: godine, afp, nakon, još, djece 
 Topic 8: web, papa, kolačića, kolačiće, film 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, kilograma 
 Topic 11: sestre, obitelji, kao, život, života 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, godine, kao, crkve 
 Topic 14: kao, tako, još, samo, nakon 
 Topic 15: kao, isusa, isus, krista, bog 
 Topic 16: fra, župe, vlč, župnik, župi 
 Topic 17: kao, godine, bog, nakon, još 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, đakovačko 
 Topic 20: kao, samo, hdz, tako, još 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, kao 
 Topic 24: kao, ljudi, samo, tako, zbog 
 Topic 25: kao, godina, godine, joj, nakon 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: josipa, godine, svetog, crkve, kao 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, hrvatske, godine, hrvatska, hrvatski 
 Topic 31: branitelja, dan, spomen, dana, rata 
 Topic 32: kao, samo, tako, treba, svoje 
 Topic 33: županije, godine, općine, grada, kao 
 Topic 34: kao, nakon, protiv, zbog, covid 
 Topic 35: biskup, antuna, košić, sisačke, biskupije 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 21 (approx. per word bound = -8.241, relative change = 1.597e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 22 (approx. per word bound = -8.239, relative change = 1.452e-04) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 23 (approx. per word bound = -8.238, relative change = 1.315e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 24 (approx. per word bound = -8.237, relative change = 1.306e-04) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 25 (approx. per word bound = -8.236, relative change = 1.259e-04) 
Topic 1: crkvu, klanjanje, preminuo, misa, godini 
 Topic 2: godine, grada, škole, škola, hrvatske 
 Topic 3: putovanja, ulica, grada, prijave, grad 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, koncert, umjetnosti 
 Topic 7: afp, nakon, godine, još, zbog 
 Topic 8: web, kolačića, kolačiće, postavke, film 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, kilograma 
 Topic 11: sestre, obitelji, život, kao, života 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, crkve, kao, godine 
 Topic 14: kao, tako, još, samo, nakon 
 Topic 15: kao, isusa, isus, bog, krista 
 Topic 16: fra, župe, vlč, župnik, don 
 Topic 17: kao, bog, godine, još, nakon 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa 
 Topic 20: kao, hdz, samo, tako, još 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, kao 
 Topic 24: kao, ljudi, samo, tako, čovjek 
 Topic 25: kao, joj, godina, godine, nakon 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: godine, josipa, crkve, svetog, kao 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, godine, hrvatske, hrvatska, hrvatski 
 Topic 31: branitelja, dan, spomen, rata, dana 
 Topic 32: kao, samo, tako, treba, svoje 
 Topic 33: županije, godine, općine, grada, kao 
 Topic 34: kao, nakon, protiv, zbog, covid 
 Topic 35: biskup, antuna, biskupije, košić, sisačke 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 26 (approx. per word bound = -8.235, relative change = 1.110e-04) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 27 (approx. per word bound = -8.234, relative change = 9.809e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 28 (approx. per word bound = -8.234, relative change = 9.339e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 29 (approx. per word bound = -8.233, relative change = 8.832e-05) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 30 (approx. per word bound = -8.232, relative change = 8.560e-05) 
Topic 1: crkvu, klanjanje, misa, preminuo, godini 
 Topic 2: godine, grada, škole, hrvatske, škola 
 Topic 3: putovanja, ulica, grada, prijave, grad 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, koncert, umjetnosti 
 Topic 7: afp, nakon, godine, još, zbog 
 Topic 8: web, kolačića, kolačiće, postavke, podataka 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, kilograma 
 Topic 11: sestre, obitelji, život, života, kao 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, crkve, kao, godine 
 Topic 14: tako, još, kao, samo, nakon 
 Topic 15: kao, isusa, isus, bog, krista 
 Topic 16: fra, župe, vlč, don, župnik 
 Topic 17: kao, bog, godine, još, dan 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa 
 Topic 20: kao, hdz, samo, tako, još 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, godine 
 Topic 24: kao, ljudi, samo, tako, čovjek 
 Topic 25: joj, kao, godina, godine, nakon 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: godine, josipa, crkve, svetog, crkva 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, godine, hrvatske, hrvatska, hrvatski 
 Topic 31: branitelja, dan, rata, spomen, dana 
 Topic 32: kao, samo, tako, treba, svoje 
 Topic 33: županije, godine, općine, grada, kao 
 Topic 34: kao, nakon, protiv, zbog, covid 
 Topic 35: biskup, antuna, biskupije, košić, potresu 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 31 (approx. per word bound = -8.232, relative change = 8.442e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 32 (approx. per word bound = -8.231, relative change = 8.397e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 33 (approx. per word bound = -8.230, relative change = 7.957e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 34 (approx. per word bound = -8.230, relative change = 8.029e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 35 (approx. per word bound = -8.229, relative change = 7.726e-05) 
Topic 1: klanjanje, crkvu, misa, godini, preminuo 
 Topic 2: godine, grada, škole, hrvatske, sati 
 Topic 3: putovanja, ulica, grada, prijave, grad 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, godina, rekla 
 Topic 6: kao, godine, kod, umjetnosti, koncert 
 Topic 7: afp, nakon, godine, još, zbog 
 Topic 8: web, kolačića, kolačiće, postavke, podataka 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, kilograma 
 Topic 11: sestre, obitelji, život, života, kao 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, crkve, crkvi, kao 
 Topic 14: tako, još, kao, samo, nakon 
 Topic 15: kao, isusa, isus, bog, krista 
 Topic 16: fra, župe, vlč, don, župnik 
 Topic 17: kao, bog, još, godine, dan 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa 
 Topic 20: kao, hdz, samo, još, tako 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, godine 
 Topic 24: kao, ljudi, samo, tako, čovjek 
 Topic 25: joj, kao, godina, nakon, marija 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: godine, josipa, crkve, svetog, crkva 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, godine, hrvatske, hrvatska, hrvatski 
 Topic 31: branitelja, rata, dan, spomen, dana 
 Topic 32: kao, samo, tako, treba, svoje 
 Topic 33: županije, godine, općine, grada, vijeća 
 Topic 34: kao, nakon, protiv, zbog, rekao 
 Topic 35: biskup, biskupije, antuna, košić, potresu 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 36 (approx. per word bound = -8.228, relative change = 7.027e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 37 (approx. per word bound = -8.228, relative change = 6.405e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 38 (approx. per word bound = -8.227, relative change = 6.237e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 39 (approx. per word bound = -8.227, relative change = 6.280e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 40 (approx. per word bound = -8.226, relative change = 6.246e-05) 
Topic 1: klanjanje, misa, crkvu, godini, preminuo 
 Topic 2: godine, grada, škole, sati, hrvatske 
 Topic 3: putovanja, ulica, grada, grad, prijave 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, rekla, godina 
 Topic 6: kao, godine, kod, umjetnosti, koncert 
 Topic 7: afp, nakon, godine, još, zbog 
 Topic 8: web, kolačića, kolačiće, postavke, podataka 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, samo 
 Topic 11: sestre, obitelji, život, života, kao 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, crkve, crkvi, kao 
 Topic 14: još, tako, kao, samo, nakon 
 Topic 15: kao, isus, isusa, bog, krista 
 Topic 16: fra, župe, vlč, don, župnik 
 Topic 17: bog, kao, još, dan, godine 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa 
 Topic 20: kao, hdz, samo, još, tako 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, godine 
 Topic 24: kao, ljudi, samo, tako, čovjek 
 Topic 25: joj, kao, godina, marija, nakon 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: godine, josipa, crkve, svetog, crkva 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, godine, hrvatske, hrvatska, hrvatski 
 Topic 31: branitelja, rata, dan, spomen, dana 
 Topic 32: kao, samo, tako, treba, ljudi 
 Topic 33: županije, općine, godine, grada, kuna 
 Topic 34: kao, nakon, protiv, zbog, rekao 
 Topic 35: biskup, biskupije, antuna, košić, potresa 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 41 (approx. per word bound = -8.226, relative change = 6.330e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 42 (approx. per word bound = -8.225, relative change = 4.961e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 43 (approx. per word bound = -8.225, relative change = 5.731e-05) 
....................................................................................................
Completed E-Step (2 seconds). 
Completed M-Step. 
Completing Iteration 44 (approx. per word bound = -8.224, relative change = 5.156e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 45 (approx. per word bound = -8.224, relative change = 6.156e-05) 
Topic 1: klanjanje, misa, godini, crkvu, presvetim 
 Topic 2: godine, grada, sati, škole, program 
 Topic 3: ulica, putovanja, grada, grad, prijave 
 Topic 4: sati, gospe, blagdan, misa, mise 
 Topic 5: kao, cropix, nakon, rekla, ana 
 Topic 6: kao, godine, kod, umjetnosti, koncert 
 Topic 7: afp, nakon, godine, još, zbog 
 Topic 8: web, kolačića, kolačiće, postavke, podataka 
 Topic 9: der, online, muzeja, die, kao 
 Topic 10: mršavljenje, tablete, kao, sadrži, samo 
 Topic 11: sestre, obitelji, život, života, kao 
 Topic 12: naslov, cookie, article, postovi, category 
 Topic 13: svećenika, svećenik, crkve, crkvi, godine 
 Topic 14: još, tako, kao, samo, nakon 
 Topic 15: kao, isus, isusa, božić, bog 
 Topic 16: fra, župe, vlč, don, župi 
 Topic 17: bog, kao, još, dan, godine 
 Topic 18: kao, samo, nema, zbog, tako 
 Topic 19: nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa 
 Topic 20: kao, hdz, samo, još, tako 
 Topic 21: hrvatske, predsjednik, hrvatskog, caritasa, vlade 
 Topic 22: laudato, kao, crkve, pravoslavne, spc 
 Topic 23: papa, franjo, crkve, pape, godine 
 Topic 24: kao, ljudi, samo, tako, čovjek 
 Topic 25: joj, marija, nakon, godina, kao 
 Topic 26: bog, isus, boga, kao, ljubav 
 Topic 27: godine, kao, projekt, projekta, području 
 Topic 28: godine, josipa, crkve, svetog, crkva 
 Topic 29: godine, kao, nakon, godina, samo 
 Topic 30: kao, godine, hrvatske, hrvatska, hrvatski 
 Topic 31: branitelja, rata, dan, spomen, dana 
 Topic 32: kao, samo, tako, treba, ljudi 
 Topic 33: županije, općine, godine, grada, kuna 
 Topic 34: kao, nakon, protiv, zbog, rekao 
 Topic 35: biskup, biskupije, antuna, košić, potresa 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 46 (approx. per word bound = -8.223, relative change = 5.720e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 47 (approx. per word bound = -8.223, relative change = 5.372e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 48 (approx. per word bound = -8.223, relative change = 5.364e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Completing Iteration 49 (approx. per word bound = -8.222, relative change = 4.691e-05) 
....................................................................................................
Completed E-Step (1 seconds). 
Completed M-Step. 
Model Terminated Before Convergence Reached </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"STM model fitted with"</span>, K, <span class="st">"topics</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>STM model fitted with 35 topics</code></pre>
</div>
</div>
<section id="topic-labels-and-top-words" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="topic-labels-and-top-words"><span class="header-section-number">2.1</span> Topic Labels and Top Words</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>topic_words <span class="ot">&lt;-</span> <span class="fu">labelTopics</span>(stm_model, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>topic_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Topic =</span> <span class="dv">1</span><span class="sc">:</span>K,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Top_Words =</span> <span class="fu">apply</span>(topic_words<span class="sc">$</span>prob, <span class="dv">1</span>, paste, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FREX_Words =</span> <span class="fu">apply</span>(topic_words<span class="sc">$</span>frex, <span class="dv">1</span>, paste, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>topic_df <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Topic"</span>, <span class="st">"Top Words (Probability)"</span>, <span class="st">"FREX Words (Distinctive)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"600px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:600px; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Topic</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Top Words (Probability)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">FREX Words (Distinctive)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">klanjanje, misa, godini, crkvu, presvetim, preminuo, crkvi, sati, molimo, srca</td>
<td style="text-align: left;">presvetim, klanjanje, oltarskim, euharistijskog, sakramentom, preminuo, zadušnica, marijina, satno, satu</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">godine, grada, sati, program, hrvatske, škole, škola, dana, udruge, udruga</td>
<td style="text-align: left;">matice, festival, manifestacije, festivala, radionica, učenici, ogranka, gimnazije, radionice, učenike</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">ulica, putovanja, grada, prijave, grad, rok, zagreb, vrijeme, sati, kao</td>
<td style="text-align: left;">ica, noćenje, rok, razgled, krapina, eur, putovanja, hotel, ulice, aranžmana</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">sati, gospe, blagdan, misa, mise, blagoslov, link, gospa, hodočašće, hvala</td>
<td style="text-align: left;">link, pretplatite, procesija, hodočašće, gospe, zvonce, ncs, release, epizode, gospa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">kao, cropix, nakon, rekla, ana, godina, hrvatskoj, žena, hrvatske, život</td>
<td style="text-align: left;">cropix, erdogan, pastor, ana, islamski, tomas, islamskog, islamske, ženama, melita</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">kao, godine, kod, umjetnosti, zagrebu, koncert, film, glazbe, hrvatske, pjesme</td>
<td style="text-align: left;">koncerta, publika, jazz, art, queer, glazbene, pjesama, glazbe, album, državna</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">afp, nakon, godine, još, zbog, rekao, kao, izrael, djece, princ</td>
<td style="text-align: left;">afp, hamasa, izrael, gaze, hamas, harry, princ, gazi, niš, izraelu</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">web, kolačića, kolačiće, postavke, podataka, google, kolačići, stranica, stranici, pristupačnosti</td>
<td style="text-align: left;">kolačići, pristupačnosti, kolačiće, kolačića, datoteke, kolačićima, postavke, našice, privatnosti, tehničko</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">der, online, muzeja, die, kao, und, još, knjiga, von, samo</td>
<td style="text-align: left;">die, der, und, nach, von, den, muzeja, bleiburg, online, igračima</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">mršavljenje, tablete, kao, sadrži, samo, kilograma, oil, name, brzo, nakon</td>
<td style="text-align: left;">mršavljenje, oil, tablete, dijeta, kožu, mršavljenja, can, black, make, maska</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">sestre, obitelji, život, života, kao, dan, molitve, sestara, ljubavi, susret</td>
<td style="text-align: left;">sestara, krunicu, družbe, terezije, krunice, invaliditetom, formacije, hod, tečaj, sestre</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">naslov, cookie, article, postovi, category, postano, pridružen, cookies, consent, kao</td>
<td style="text-align: left;">postovi, postano, pridružen, article, category, consent, user, rva, cookie, lip</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">svećenika, svećenik, crkve, crkvi, godine, kao, zbog, crkva, nakon, nadbiskup</td>
<td style="text-align: left;">zlostavljanja, zlostavljanje, seksualnog, maloljetnika, seksualno, uzinić, svećenika, gospićko, svećenik, biskupi</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">tako, još, kao, samo, nakon, prije, godina, dobro, dana, vrijeme</td>
<td style="text-align: left;">slaven, utakmice, utakmica, minuti, gorice, minuta, utakmicu, jelo, moraš, gorica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">kao, isus, božić, bog, isusa, vrijeme, krista, biskup, tako, crkva</td>
<td style="text-align: left;">kristova, božić, božića, spasenja, došašća, euharistiji, otajstvo, uskrs, rođenje, euharistije</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: left;">fra, župe, vlč, don, župi, župnik, biskup, godine, slavlje, predvodio</td>
<td style="text-align: left;">fra, župi, vlč, preč, radoš, župe, predslavio, franjevačke, razriješen, župnikom</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: left;">bog, kao, još, dan, godine, swift, molitva, kanalu, biblija, dana</td>
<td style="text-align: left;">swift, banka, biblija, ostanimo, slijedeće, uplaćuju, kanala, priloge, tube, code</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: left;">kao, samo, nema, zbog, tako, ljudi, godine, eura, godina, prije</td>
<td style="text-align: left;">rimac, gabrić, mirovinu, quote, tportal, bolnice, srđan, medicinski, dvorima, bergoglio</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: left;">nadbiskup, mons, nadbiskupije, kardinal, nadbiskupa, đakovačko, bozanić, stepinca, splitsko, zagrebački</td>
<td style="text-align: left;">bozanić, kutleša, đakovačko, puljić, osječke, nadbiskupije, metropolit, ćurić, nadbiskup, koadjutor</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: left;">kao, hdz, samo, još, tako, hrvatske, hrvatskoj, milanović, predsjednik, hrvatska</td>
<td style="text-align: left;">hdz, sdp, milanović, plenkovića, telegram, primorac, milanovića, stranka, stranke, raspudić</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td style="text-align: left;">hrvatske, predsjednik, hrvatskog, caritasa, vlade, ministar, kao, hrvatski, republike, plenković</td>
<td style="text-align: left;">caritasa, ministar, morh, ministra, gordan, jandroković, sabora, bratovštine, caritas, plenković</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td style="text-align: left;">laudato, kao, crkve, pravoslavne, spc, crkva, emisije, ljudi, televizija, kontakt</td>
<td style="text-align: left;">laudato, spc, pravoslavne, televizija, porfirije, pravoslavna, patrijarh, laudatotv, hkr, patrijarha</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: left;">papa, franjo, crkve, pape, godine, kao, vatikan, nakon, rekao, kardinal</td>
<td style="text-align: left;">papa, franjo, vatikanu, vatikan, papu, papom, pape, stolice, vatican, koncila</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td style="text-align: left;">kao, ljudi, samo, tako, čovjek, svoje, svijet, još, zbog, način</td>
<td style="text-align: left;">bića, patnja, muslimani, čovječanstva, biće, znanost, patnju, ego, zvijeri, civilizacije</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25</td>
<td style="text-align: left;">joj, nakon, godina, marija, kao, godine, majka, dijete, rekla, svoje</td>
<td style="text-align: left;">stanković, marica, molim, tražim, marice, baka, znala, joj, vidjela, rođena</td>
</tr>
<tr class="even">
<td style="text-align: right;">26</td>
<td style="text-align: left;">bog, isus, boga, kao, svoje, ljubav, život, ljubavi, bogu, samo</td>
<td style="text-align: left;">amen, gospodine, reče, smiluj, isuse, milost, grijehe, majko, oče, marijo</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27</td>
<td style="text-align: left;">godine, kao, projekt, projekta, području, grada, prirode, eura, prostor, još</td>
<td style="text-align: left;">parka, životinja, golf, projekta, prirode, kamene, površina, motor, gastronomske, klima</td>
</tr>
<tr class="even">
<td style="text-align: right;">28</td>
<td style="text-align: left;">godine, josipa, crkve, svetog, crkva, kao, nakon, godina, kuće, prije</td>
<td style="text-align: left;">josipu, sente, josipa, kapela, karlovcu, kip, zvonika, kapele, kapelu, zgrada</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29</td>
<td style="text-align: left;">godine, kao, nakon, godina, samo, još, svoje, kasnije, tako, smrti</td>
<td style="text-align: left;">kata, ubijen, šoljić, umro, rođen, današnji, cara, romi, veneciji, braće</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td style="text-align: left;">kao, godine, hrvatske, hrvatska, hrvatskoj, hrvatski, samo, naroda, nakon, tako</td>
<td style="text-align: left;">jasenovac, ids, jasenovcu, pokolj, zločina, genocid, ndh, komunističkih, zločin, komunistički</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31</td>
<td style="text-align: left;">branitelja, rata, dan, spomen, domovinskog, dana, hrvatskih, hrvatske, godine, sjećanja</td>
<td style="text-align: left;">vukovar, poginule, brigade, vukovara, škabrnje, vijenaca, branitelja, gardijske, branitelje, spomen</td>
</tr>
<tr class="even">
<td style="text-align: right;">32</td>
<td style="text-align: left;">kao, samo, tako, treba, ljudi, svoje, način, stvari, postoji, često</td>
<td style="text-align: left;">brak, roditeljima, nacional, braku, odnos, partner, osjećaje, stvari, nekoga, osjećate</td>
</tr>
<tr class="odd">
<td style="text-align: right;">33</td>
<td style="text-align: left;">županije, općine, godine, grada, kuna, vijeća, kao, županiji, osoba, području</td>
<td style="text-align: left;">crvenog, županiji, županije, međimurske, županijske, koprivničko, župana, općinskog, županija, općine</td>
</tr>
<tr class="even">
<td style="text-align: right;">34</td>
<td style="text-align: left;">kao, nakon, protiv, zbog, rekao, covid, ukrajini, još, godine, predsjednik</td>
<td style="text-align: left;">ruske, cjepiva, cjepivo, trump, pcr, trumpa, ruskog, rusija, cijepljenja, ruska</td>
</tr>
<tr class="odd">
<td style="text-align: right;">35</td>
<td style="text-align: left;">biskup, biskupije, antuna, potresa, košić, potresu, sisačke, pomoć, sisku, crkvi</td>
<td style="text-align: left;">košić, sisačke, potresu, antuna, padovanskog, stipić, petrinji, potresom, sisački, nuncij</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="topic-prevalence-overview" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="topic-prevalence-overview"><span class="header-section-number">2.2</span> Topic Prevalence Overview</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>topic_proportions <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(stm_model<span class="sc">$</span>theta)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>topic_prev_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Topic =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span>K),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Prevalence =</span> topic_proportions <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Prevalence)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Topic =</span> <span class="fu">factor</span>(Topic, <span class="at">levels =</span> Topic))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(topic_prev_df, <span class="fu">aes</span>(<span class="at">x =</span> Topic, <span class="at">y =</span> Prevalence)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#2c5f7c"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Prevalence)), </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(topic_prev_df<span class="sc">$</span>Prevalence) <span class="sc">*</span> <span class="fl">1.15</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Topic Prevalence in Corpus"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Distribution across"</span>, K, <span class="st">"topics"</span>),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Topic"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Prevalence (%)"</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/topic-prevalence-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="topic-word-clouds" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="topic-word-clouds"><span class="header-section-number">2.3</span> Topic Word Clouds</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cloud</span>(stm_model, <span class="at">topic =</span> i, <span class="at">max.words =</span> <span class="dv">30</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Topic"</span>, i))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/topic-wordclouds-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="analysis-2.2-topic-taxonomy" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis 2.2: Topic Taxonomy</h1>
<p>Group discovered topics into higher order thematic categories based on manual inspection of top words.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>topic_taxonomy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Topic =</span> <span class="dv">1</span><span class="sc">:</span>K,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>topic_taxonomy<span class="sc">$</span>Category <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>topic_taxonomy<span class="sc">$</span>Label <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>topic_words_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="cf">function</span>(i) {</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(topic_words<span class="sc">$</span>prob[i, ], topic_words<span class="sc">$</span>frex[i, ])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>liturgical_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"misa"</span>, <span class="st">"mise"</span>, <span class="st">"nedjelja"</span>, <span class="st">"svetkovina"</span>, <span class="st">"liturgi"</span>, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"sakrament"</span>, <span class="st">"euharistij"</span>, <span class="st">"krizm"</span>, <span class="st">"krst"</span>, <span class="st">"pričest"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"uskrs"</span>, <span class="st">"božić"</span>, <span class="st">"advent"</span>, <span class="st">"korizma"</span>, <span class="st">"vazmeni"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>devotional_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"molitva"</span>, <span class="st">"molit"</span>, <span class="st">"gospa"</span>, <span class="st">"marij"</span>, <span class="st">"svetac"</span>, <span class="st">"sveti"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"duhov"</span>, <span class="st">"vjera"</span>, <span class="st">"krist"</span>, <span class="st">"isus"</span>, <span class="st">"srce"</span>, <span class="st">"ljubav"</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"blagoslov"</span>, <span class="st">"zahval"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>institutional_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"biskupij"</span>, <span class="st">"nadbiskup"</span>, <span class="st">"biskup"</span>, <span class="st">"papa"</span>, <span class="st">"vatikan"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"hbk"</span>, <span class="st">"kardinal"</span>, <span class="st">"dekret"</span>, <span class="st">"imenovan"</span>, <span class="st">"župnik"</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>social_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"obitelj"</span>, <span class="st">"život"</span>, <span class="st">"djeca"</span>, <span class="st">"brak"</span>, <span class="st">"pobačaj"</span>, <span class="st">"caritas"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"siromašn"</span>, <span class="st">"pomoć"</span>, <span class="st">"društv"</span>, <span class="st">"socijal"</span>, <span class="st">"rad"</span>, <span class="st">"posao"</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>political_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"vlada"</span>, <span class="st">"izborn"</span>, <span class="st">"politič"</span>, <span class="st">"zakon"</span>, <span class="st">"država"</span>, <span class="st">"nacija"</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"hrvat"</span>, <span class="st">"rat"</span>, <span class="st">"povijes"</span>, <span class="st">"domovina"</span>, <span class="st">"domoljub"</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>youth_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mladi"</span>, <span class="st">"škola"</span>, <span class="st">"student"</span>, <span class="st">"frama"</span>, <span class="st">"shkm"</span>, <span class="st">"ministran"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"kamp"</span>, <span class="st">"susret"</span>, <span class="st">"zajednic"</span>, <span class="st">"program"</span>, <span class="st">"aktivnost"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>educational_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"kateh"</span>, <span class="st">"teolog"</span>, <span class="st">"biblij"</span>, <span class="st">"evanđelj"</span>, <span class="st">"pouka"</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"učenj"</span>, <span class="st">"knjiga"</span>, <span class="st">"čitanj"</span>, <span class="st">"znanje"</span>, <span class="st">"obrazov"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>assign_category <span class="ot">&lt;-</span> <span class="cf">function</span>(words, topic_num) {</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  words_str <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">paste</span>(words, <span class="at">collapse =</span> <span class="st">" "</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Liturgical =</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(liturgical_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Devotional =</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(devotional_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Institutional =</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(institutional_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Social/Ethical"</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(social_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Political =</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(political_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Youth/Community"</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(youth_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str))),</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Educational =</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(educational_keywords, <span class="cf">function</span>(k) <span class="fu">grepl</span>(k, words_str)))</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">max</span>(scores) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(<span class="fu">which.max</span>(scores))</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  topic_taxonomy<span class="sc">$</span>Category[i] <span class="ot">&lt;-</span> <span class="fu">assign_category</span>(topic_words_list[[i]], i)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  topic_taxonomy<span class="sc">$</span>Label[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Topic "</span>, i, <span class="st">": "</span>, </span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">paste</span>(topic_words<span class="sc">$</span>frex[i, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>topic_taxonomy <span class="sc">%&gt;%</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Category, Topic) <span class="sc">%&gt;%</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_prev_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Prevalence) <span class="sc">%&gt;%</span> </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Topic =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Topic))), <span class="at">by =</span> <span class="st">"Topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Topic"</span>, <span class="st">"Category"</span>, <span class="st">"Label"</span>, <span class="st">"Prevalence (%)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Topic</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Category</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Label</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Prevalence (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">Topic 11: sestara, krunicu, družbe</td>
<td style="text-align: right;">3.5532651</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">Topic 17: swift, banka, biblija</td>
<td style="text-align: right;">2.2605271</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">Topic 25: stanković, marica, molim</td>
<td style="text-align: right;">1.9991845</td>
</tr>
<tr class="even">
<td style="text-align: right;">26</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">Topic 26: amen, gospodine, reče</td>
<td style="text-align: right;">6.4717868</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Educational</td>
<td style="text-align: left;">Topic 9: die, der, und</td>
<td style="text-align: right;">0.8163881</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">Topic 13: zlostavljanja, zlostavljanje, seksualnog</td>
<td style="text-align: right;">3.1842559</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: right;">7.4378829</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: right;">4.3090934</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">Topic 23: papa, franjo, vatikanu</td>
<td style="text-align: right;">5.0809636</td>
</tr>
<tr class="even">
<td style="text-align: right;">35</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">Topic 35: košić, sisačke, potresu</td>
<td style="text-align: right;">2.2148090</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">Topic 1: presvetim, klanjanje, oltarskim</td>
<td style="text-align: right;">1.6257133</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">Topic 4: link, pretplatite, procesija</td>
<td style="text-align: right;">5.8355110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">Topic 15: kristova, božić, božića</td>
<td style="text-align: right;">4.6627153</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 7: afp, hamasa, izrael</td>
<td style="text-align: right;">1.4041787</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 8: kolačići, pristupačnosti, kolačiće</td>
<td style="text-align: right;">1.2985549</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 10: mršavljenje, oil, tablete</td>
<td style="text-align: right;">1.2296186</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 12: postovi, postano, pridružen</td>
<td style="text-align: right;">0.8711065</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 14: slaven, utakmice, utakmica</td>
<td style="text-align: right;">3.3516046</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: right;">2.1123028</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 22: laudato, spc, pravoslavne</td>
<td style="text-align: right;">2.1392884</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 24: bića, patnja, muslimani</td>
<td style="text-align: right;">2.2937795</td>
</tr>
<tr class="even">
<td style="text-align: right;">29</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 29: kata, ubijen, šoljić</td>
<td style="text-align: right;">2.6125985</td>
</tr>
<tr class="odd">
<td style="text-align: right;">34</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 34: ruske, cjepiva, cjepivo</td>
<td style="text-align: right;">2.4358171</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">Topic 6: koncerta, publika, jazz</td>
<td style="text-align: right;">3.0123118</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">Topic 20: hdz, sdp, milanović</td>
<td style="text-align: right;">2.4258670</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">Topic 21: caritasa, ministar, morh</td>
<td style="text-align: right;">2.8237524</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">Topic 30: jasenovac, ids, jasenovcu</td>
<td style="text-align: right;">2.1006689</td>
</tr>
<tr class="even">
<td style="text-align: right;">31</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">Topic 31: vukovar, poginule, brigade</td>
<td style="text-align: right;">3.4469798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 3: ica, noćenje, rok</td>
<td style="text-align: right;">2.1169452</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 5: cropix, erdogan, pastor</td>
<td style="text-align: right;">1.0974253</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 27: parka, životinja, golf</td>
<td style="text-align: right;">2.2613149</td>
</tr>
<tr class="even">
<td style="text-align: right;">28</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 28: josipu, sente, josipa</td>
<td style="text-align: right;">2.6809691</td>
</tr>
<tr class="odd">
<td style="text-align: right;">32</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 32: brak, roditeljima, nacional</td>
<td style="text-align: right;">2.8839184</td>
</tr>
<tr class="even">
<td style="text-align: right;">33</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">Topic 33: crvenog, županiji, županije</td>
<td style="text-align: right;">2.5826801</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Youth/Community</td>
<td style="text-align: left;">Topic 2: matice, festival, manifestacije</td>
<td style="text-align: right;">3.3662217</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="category-distribution" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="category-distribution"><span class="header-section-number">3.1</span> Category Distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>category_prevalence <span class="ot">&lt;-</span> topic_taxonomy <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_prev_df <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Topic =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Topic))), <span class="at">by =</span> <span class="st">"Topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Topics =</span> <span class="fu">n</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Prevalence =</span> <span class="fu">sum</span>(Prevalence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Prevalence))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_prevalence, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Category, Total_Prevalence), </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> Total_Prevalence, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%</span><span class="sc">\n</span><span class="st">(%d topics)"</span>, Total_Prevalence, Topics)),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(category_prevalence<span class="sc">$</span>Total_Prevalence) <span class="sc">*</span> <span class="fl">1.25</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Thematic Category Distribution"</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Aggregated prevalence by topic category"</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Prevalence (%)"</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/category-distribution-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-2.3-topic-by-actor-mapping" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Analysis 2.3: Topic by Actor Mapping</h1>
<p>Examine how different actor types specialize in particular topics.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>doc_topics <span class="ot">&lt;-</span> stm_model<span class="sc">$</span>theta</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(doc_topics) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Topic_"</span>, <span class="dv">1</span><span class="sc">:</span>K)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>doc_meta <span class="ot">&lt;-</span> stm_dfm<span class="sc">$</span>meta</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>doc_meta <span class="ot">&lt;-</span> <span class="fu">cbind</span>(doc_meta, doc_topics)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>actor_topic_means <span class="ot">&lt;-</span> doc_meta <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(actor_type) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Topic_"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>actor_topic_long <span class="ot">&lt;-</span> actor_topic_means <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Topic_"</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Topic"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Topic_Num =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Topic_"</span>, <span class="st">""</span>, Topic)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="topic-proportions-by-actor-type-heatmap" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="topic-proportions-by-actor-type-heatmap"><span class="header-section-number">4.1</span> Topic Proportions by Actor Type Heatmap</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>actor_topic_matrix <span class="ot">&lt;-</span> actor_topic_means <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"actor_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(actor_topic_matrix) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>K</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>topic_annotations <span class="ot">&lt;-</span> topic_taxonomy <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Topic, Category) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Topic =</span> <span class="fu">as.character</span>(Topic)) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Topic"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(actor_topic_matrix) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#2c5f7c"</span>, <span class="st">"#1a3c5a"</span>))(<span class="dv">100</span>),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Topic Proportions by Actor Type (%)"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize_row =</span> <span class="dv">8</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize_col =</span> <span class="dv">9</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">angle_col =</span> <span class="dv">45</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">border_color =</span> <span class="st">"grey90"</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/actor-topic-heatmap-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="actor-specialization-index" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="actor-specialization-index"><span class="header-section-number">4.2</span> Actor Specialization Index</h2>
<p>Calculate how specialized each actor type is compared to corpus average.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>corpus_avg <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(doc_topics)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>specialization_df <span class="ot">&lt;-</span> actor_topic_long <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">Topic_Num =</span> <span class="dv">1</span><span class="sc">:</span>K, <span class="at">Corpus_Avg =</span> corpus_avg), <span class="at">by =</span> <span class="st">"Topic_Num"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lift =</span> Proportion <span class="sc">/</span> Corpus_Avg,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Log_Lift =</span> <span class="fu">log2</span>(Lift)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_taxonomy <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Category, Label) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">Topic_Num =</span> Topic), <span class="at">by =</span> <span class="st">"Topic_Num"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>top_specializations <span class="ot">&lt;-</span> specialization_df <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.finite</span>(Log_Lift)) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(actor_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(Log_Lift, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>top_specializations <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(actor_type, Label, Category, Lift) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lift =</span> <span class="fu">sprintf</span>(<span class="st">"%.2fx"</span>, Lift)) <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(actor_type) <span class="sc">%&gt;%</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actor Type"</span>, <span class="st">"Topic"</span>, <span class="st">"Category"</span>, <span class="st">"Lift vs Corpus"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Actor Type</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Topic</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Category</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Lift vs Corpus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">Topic 8: kolačići, pristupačnosti, kolačiće</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">48.63x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">4.15x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">1.25x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Charismatic Communities</td>
<td style="text-align: left;">Topic 17: swift, banka, biblija</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">13.80x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Charismatic Communities</td>
<td style="text-align: left;">Topic 11: sestara, krunicu, družbe</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">9.06x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Charismatic Communities</td>
<td style="text-align: left;">Topic 10: mršavljenje, oil, tablete</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">8.27x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">Topic 11: sestara, krunicu, družbe</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">3.75x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">3.43x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">3.41x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">Topic 22: laudato, spc, pravoslavne</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">9.15x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">Topic 23: papa, franjo, vatikanu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">2.57x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">2.11x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Individual Priests</td>
<td style="text-align: left;">Topic 4: link, pretplatite, procesija</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">9.11x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Individual Priests</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">4.05x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Individual Priests</td>
<td style="text-align: left;">Topic 1: presvetim, klanjanje, oltarskim</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">1.84x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">2.22x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">Topic 11: sestara, krunicu, družbe</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">2.21x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">2.14x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">Topic 17: swift, banka, biblija</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">7.07x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">Topic 4: link, pretplatite, procesija</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">4.62x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">Topic 26: amen, gospodine, reče</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">3.94x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1.34x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 7: afp, hamasa, izrael</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1.33x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Topic 30: jasenovac, ids, jasenovcu</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">1.31x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Religious Orders</td>
<td style="text-align: left;">Topic 33: crvenog, županiji, županije</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">4.80x</td>
</tr>
<tr class="even">
<td style="text-align: left;">Religious Orders</td>
<td style="text-align: left;">Topic 27: parka, životinja, golf</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">2.81x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Religious Orders</td>
<td style="text-align: left;">Topic 12: postovi, postano, pridružen</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2.28x</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="actor-type-topic-profiles" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="actor-type-topic-profiles"><span class="header-section-number">4.3</span> Actor Type Topic Profiles</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>category_by_actor <span class="ot">&lt;-</span> specialization_df <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(actor_type, Category) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Category_Proportion =</span> <span class="fu">sum</span>(Proportion), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_by_actor, <span class="fu">aes</span>(<span class="at">x =</span> Category, <span class="at">y =</span> Category_Proportion, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>actor_type, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">round</span>(x <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Thematic Category Profiles by Actor Type"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"What each actor type talks about"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion of Content"</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/actor-profiles-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-2.4-topic-by-platform-mapping" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analysis 2.4: Topic by Platform Mapping</h1>
<p>How do topics vary across digital platforms?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>platform_topic_means <span class="ot">&lt;-</span> doc_meta <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(platform) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Topic_"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>platform_topic_long <span class="ot">&lt;-</span> platform_topic_means <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Topic_"</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Topic"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Topic_Num =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Topic_"</span>, <span class="st">""</span>, Topic))) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_taxonomy <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Category, Label) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">Topic_Num =</span> Topic), <span class="at">by =</span> <span class="st">"Topic_Num"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="platform-topic-heatmap" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="platform-topic-heatmap"><span class="header-section-number">5.1</span> Platform Topic Heatmap</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>platform_topic_matrix <span class="ot">&lt;-</span> platform_topic_means <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"platform"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(platform_topic_matrix) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>K</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(platform_topic_matrix) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#e07b39"</span>, <span class="st">"#c44536"</span>))(<span class="dv">100</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Topic Proportions by Platform (%)"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize_row =</span> <span class="dv">8</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">angle_col =</span> <span class="dv">45</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">border_color =</span> <span class="st">"grey90"</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/platform-topic-heatmap-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="platform-category-profiles" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="platform-category-profiles"><span class="header-section-number">5.2</span> Platform Category Profiles</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>category_by_platform <span class="ot">&lt;-</span> platform_topic_long <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(platform, Category) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Category_Proportion =</span> <span class="fu">sum</span>(Proportion), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_by_platform, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(platform, Category_Proportion), </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> Category_Proportion, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Thematic Composition by Platform"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Relative distribution of topic categories"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Category"</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/platform-profiles-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="platform-specialization" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="platform-specialization"><span class="header-section-number">5.3</span> Platform Specialization</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>platform_spec <span class="ot">&lt;-</span> platform_topic_long <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">Topic_Num =</span> <span class="dv">1</span><span class="sc">:</span>K, <span class="at">Corpus_Avg =</span> corpus_avg), <span class="at">by =</span> <span class="st">"Topic_Num"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lift =</span> Proportion <span class="sc">/</span> Corpus_Avg) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(platform) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(Lift, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>platform_spec <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(platform, Label, Category, Lift) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lift =</span> <span class="fu">sprintf</span>(<span class="st">"%.2fx"</span>, Lift)) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(platform, <span class="fu">desc</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"x"</span>, <span class="st">""</span>, Lift)))) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Platform"</span>, <span class="st">"Topic"</span>, <span class="st">"Category"</span>, <span class="st">"Lift"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Platform</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Topic</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Category</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Lift</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">comment</td>
<td style="text-align: left;">Topic 20: hdz, sdp, milanović</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">5.88x</td>
</tr>
<tr class="even">
<td style="text-align: left;">comment</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">5.14x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comment</td>
<td style="text-align: left;">Topic 1: presvetim, klanjanje, oltarskim</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">5.14x</td>
</tr>
<tr class="even">
<td style="text-align: left;">comment</td>
<td style="text-align: left;">Topic 24: bića, patnja, muslimani</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">3.90x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comment</td>
<td style="text-align: left;">Topic 9: die, der, und</td>
<td style="text-align: left;">Educational</td>
<td style="text-align: left;">3.79x</td>
</tr>
<tr class="even">
<td style="text-align: left;">facebook</td>
<td style="text-align: left;">Topic 26: amen, gospodine, reče</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">3.04x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">facebook</td>
<td style="text-align: left;">Topic 35: košić, sisačke, potresu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">1.86x</td>
</tr>
<tr class="even">
<td style="text-align: left;">facebook</td>
<td style="text-align: left;">Topic 25: stanković, marica, molim</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">1.63x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">facebook</td>
<td style="text-align: left;">Topic 23: papa, franjo, vatikanu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">1.51x</td>
</tr>
<tr class="even">
<td style="text-align: left;">facebook</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">1.46x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">forum</td>
<td style="text-align: left;">Topic 24: bića, patnja, muslimani</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">11.20x</td>
</tr>
<tr class="even">
<td style="text-align: left;">forum</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">6.69x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">forum</td>
<td style="text-align: left;">Topic 20: hdz, sdp, milanović</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">3.63x</td>
</tr>
<tr class="even">
<td style="text-align: left;">forum</td>
<td style="text-align: left;">Topic 32: brak, roditeljima, nacional</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">3.07x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">forum</td>
<td style="text-align: left;">Topic 14: slaven, utakmice, utakmica</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2.39x</td>
</tr>
<tr class="even">
<td style="text-align: left;">instagram</td>
<td style="text-align: left;">Topic 10: mršavljenje, oil, tablete</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">14.79x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">instagram</td>
<td style="text-align: left;">Topic 1: presvetim, klanjanje, oltarskim</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">10.03x</td>
</tr>
<tr class="even">
<td style="text-align: left;">instagram</td>
<td style="text-align: left;">Topic 3: ica, noćenje, rok</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">7.46x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">instagram</td>
<td style="text-align: left;">Topic 35: košić, sisačke, potresu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">3.01x</td>
</tr>
<tr class="even">
<td style="text-align: left;">instagram</td>
<td style="text-align: left;">Topic 2: matice, festival, manifestacije</td>
<td style="text-align: left;">Youth/Community</td>
<td style="text-align: left;">2.35x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">reddit</td>
<td style="text-align: left;">Topic 5: cropix, erdogan, pastor</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">5.92x</td>
</tr>
<tr class="even">
<td style="text-align: left;">reddit</td>
<td style="text-align: left;">Topic 14: slaven, utakmice, utakmica</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">5.78x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">reddit</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">3.66x</td>
</tr>
<tr class="even">
<td style="text-align: left;">reddit</td>
<td style="text-align: left;">Topic 24: bića, patnja, muslimani</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">3.30x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">reddit</td>
<td style="text-align: left;">Topic 13: zlostavljanja, zlostavljanje, seksualnog</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">2.81x</td>
</tr>
<tr class="even">
<td style="text-align: left;">twitter</td>
<td style="text-align: left;">Topic 30: jasenovac, ids, jasenovcu</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">5.81x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">twitter</td>
<td style="text-align: left;">Topic 12: postovi, postano, pridružen</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">5.28x</td>
</tr>
<tr class="even">
<td style="text-align: left;">twitter</td>
<td style="text-align: left;">Topic 35: košić, sisačke, potresu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">4.96x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">twitter</td>
<td style="text-align: left;">Topic 20: hdz, sdp, milanović</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">3.04x</td>
</tr>
<tr class="even">
<td style="text-align: left;">twitter</td>
<td style="text-align: left;">Topic 18: rimac, gabrić, mirovinu</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2.82x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">web</td>
<td style="text-align: left;">Topic 34: ruske, cjepiva, cjepivo</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1.19x</td>
</tr>
<tr class="even">
<td style="text-align: left;">web</td>
<td style="text-align: left;">Topic 21: caritasa, ministar, morh</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">1.19x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">web</td>
<td style="text-align: left;">Topic 33: crvenog, županiji, županije</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">1.18x</td>
</tr>
<tr class="even">
<td style="text-align: left;">web</td>
<td style="text-align: left;">Topic 27: parka, životinja, golf</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">1.18x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">web</td>
<td style="text-align: left;">Topic 12: postovi, postano, pridružen</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1.18x</td>
</tr>
<tr class="even">
<td style="text-align: left;">youtube</td>
<td style="text-align: left;">Topic 17: swift, banka, biblija</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">5.30x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">youtube</td>
<td style="text-align: left;">Topic 22: laudato, spc, pravoslavne</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">5.20x</td>
</tr>
<tr class="even">
<td style="text-align: left;">youtube</td>
<td style="text-align: left;">Topic 4: link, pretplatite, procesija</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">4.13x</td>
</tr>
<tr class="odd">
<td style="text-align: left;">youtube</td>
<td style="text-align: left;">Topic 1: presvetim, klanjanje, oltarskim</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">3.39x</td>
</tr>
<tr class="even">
<td style="text-align: left;">youtube</td>
<td style="text-align: left;">Topic 26: amen, gospodine, reče</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">2.17x</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-2.5-topic-engagement-differential" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Analysis 2.5: Topic Engagement Differential</h1>
<p>Which topics generate more engagement?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>doc_engagement <span class="ot">&lt;-</span> dta_sample[, .(doc_id, INTERACTIONS, REACH)]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create row indices for joining</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>doc_meta_with_id <span class="ot">&lt;-</span> doc_meta <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>doc_engagement_with_id <span class="ot">&lt;-</span> doc_engagement <span class="sc">|&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Join by row_id since both datasets have same order</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>doc_meta_eng <span class="ot">&lt;-</span> doc_meta_with_id <span class="sc">|&gt;</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(doc_engagement_with_id, <span class="at">by =</span> <span class="st">"row_id"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"_y"</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Now proceed with topic engagement calculation</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>topic_engagement <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="cf">function</span>(t) {</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  topic_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Topic_"</span>, t)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  doc_meta_eng <span class="sc">|&gt;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">weight =</span> .data[[topic_col]]) <span class="sc">|&gt;</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">Topic =</span> t,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">Weighted_Mean_Engagement =</span> <span class="fu">weighted.mean</span>(INTERACTIONS, weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Engagement =</span> <span class="fu">mean</span>(INTERACTIONS[.data[[topic_col]] <span class="sc">&gt;</span> <span class="fl">0.1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Engagement =</span> <span class="fu">sum</span>(INTERACTIONS <span class="sc">*</span> weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Document_Count =</span> <span class="fu">sum</span>(.data[[topic_col]] <span class="sc">&gt;</span> <span class="fl">0.1</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>topic_engagement <span class="ot">&lt;-</span> topic_engagement <span class="sc">|&gt;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_taxonomy, <span class="at">by =</span> <span class="st">"Topic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_prev_df <span class="sc">|&gt;</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Topic =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Topic))), <span class="at">by =</span> <span class="st">"Topic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="topic-engagement-ranking" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="topic-engagement-ranking"><span class="header-section-number">6.1</span> Topic Engagement Ranking</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(topic_engagement, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">factor</span>(Topic), Weighted_Mean_Engagement),</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> Weighted_Mean_Engagement, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Weighted_Mean_Engagement, <span class="dv">0</span>)), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(topic_engagement<span class="sc">$</span>Weighted_Mean_Engagement, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fl">1.15</span>)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Engagement by Topic"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Weighted mean interactions per document"</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Topic"</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weighted Mean Engagement"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Category"</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/topic-engagement-chart-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="volume-vs-engagement-comparison" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="volume-vs-engagement-comparison"><span class="header-section-number">6.2</span> Volume vs Engagement Comparison</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>topic_engagement <span class="ot">&lt;-</span> topic_engagement <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prevalence_Rank =</span> <span class="fu">rank</span>(<span class="sc">-</span>Prevalence),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Engagement_Rank =</span> <span class="fu">rank</span>(<span class="sc">-</span>Weighted_Mean_Engagement),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Engagement_Efficiency =</span> Engagement_Rank <span class="sc">-</span> Prevalence_Rank</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(topic_engagement, <span class="fu">aes</span>(<span class="at">x =</span> Prevalence, <span class="at">y =</span> Weighted_Mean_Engagement)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Category, <span class="at">size =</span> Total_Engagement), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> Topic), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span>), <span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Topic Prevalence vs Engagement"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Points above the trend line are engagement overperformers"</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Prevalence (%)"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weighted Mean Engagement"</span>,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Category"</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"Total Engagement"</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/volume-vs-engagement-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="engagement-efficiency-by-category" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="engagement-efficiency-by-category"><span class="header-section-number">6.3</span> Engagement Efficiency by Category</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>category_engagement <span class="ot">&lt;-</span> topic_engagement <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Engagement =</span> <span class="fu">mean</span>(Weighted_Mean_Engagement, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Prevalence =</span> <span class="fu">sum</span>(Prevalence),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Engagement_per_Prevalence =</span> Mean_Engagement <span class="sc">/</span> Total_Prevalence,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Engagement_per_Prevalence))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_engagement, <span class="fu">aes</span>(<span class="at">x =</span> Total_Prevalence, <span class="at">y =</span> Mean_Engagement)) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Category), <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> Category), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Category Prevalence vs Engagement"</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Which thematic categories punch above their weight?"</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Total Prevalence (%)"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Engagement per Topic"</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/category-engagement-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Finding on Engagement Differential
</div>
</div>
<div class="callout-body-container callout-body">
<p>Topics in the Political and Social/Ethical categories often generate disproportionately high engagement relative to their prevalence, supporting the hypothesis that controversial content attracts more attention.</p>
</div>
</div>
</section>
</section>
<section id="analysis-2.6-temporal-topic-trends" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Analysis 2.6: Temporal Topic Trends</h1>
<p>How do topics evolve over time?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>yearly_topics <span class="ot">&lt;-</span> doc_meta <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Topic_"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Topic_"</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Topic"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Proportion"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Topic_Num =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Topic_"</span>, <span class="st">""</span>, Topic))) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(topic_taxonomy <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Category) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="at">Topic_Num =</span> Topic), <span class="at">by =</span> <span class="st">"Topic_Num"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>category_yearly <span class="ot">&lt;-</span> yearly_topics <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, Category) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(category_yearly, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Thematic Evolution Over Time"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Category proportions by year"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Category"</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_2_thematic_files/figure-html/temporal-topics-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="top-growing-and-declining-topics" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="top-growing-and-declining-topics"><span class="header-section-number">7.1</span> Top Growing and Declining Topics</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>yearly_wide <span class="ot">&lt;-</span> doc_meta <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Topic_"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(yearly_wide) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  first_year <span class="ot">&lt;-</span> yearly_wide<span class="sc">$</span>year[<span class="dv">1</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  last_year <span class="ot">&lt;-</span> yearly_wide<span class="sc">$</span>year[<span class="fu">nrow</span>(yearly_wide)]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  topic_trends <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Topic =</span> <span class="dv">1</span><span class="sc">:</span>K,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Start =</span> <span class="fu">as.numeric</span>(yearly_wide[<span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"Topic_"</span>, <span class="dv">1</span><span class="sc">:</span>K)]),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">End =</span> <span class="fu">as.numeric</span>(yearly_wide[<span class="fu">nrow</span>(yearly_wide), <span class="fu">paste0</span>(<span class="st">"Topic_"</span>, <span class="dv">1</span><span class="sc">:</span>K)])</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Change =</span> End <span class="sc">-</span> Start,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Pct_Change =</span> (End <span class="sc">-</span> Start) <span class="sc">/</span> Start <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(topic_taxonomy, <span class="at">by =</span> <span class="st">"Topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Change))</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Top 5 Growing Topics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(topic_trends <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Label, Category, Change, Pct_Change), <span class="dv">5</span>))</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top 5 Declining Topics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tail</span>(topic_trends <span class="sc">%&gt;%</span> <span class="fu">select</span>(Topic, Label, Category, Change, Pct_Change), <span class="dv">5</span>))</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 Growing Topics:
  Topic                                    Label        Category     Change
1     4    Topic 4: link, pretplatite, procesija      Liturgical 0.04010870
2     2 Topic 2: matice, festival, manifestacije Youth/Community 0.01808130
3     6         Topic 6: koncerta, publika, jazz       Political 0.01740335
4    14     Topic 14: slaven, utakmice, utakmica           Other 0.01700584
5    27         Topic 27: parka, životinja, golf  Social/Ethical 0.01629084
  Pct_Change
1  112.04112
2   67.30570
3   64.31025
4   67.02695
5   82.06440

Top 5 Declining Topics:
   Topic                                              Label      Category
31    23                   Topic 23: papa, franjo, vatikanu Institutional
32    13 Topic 13: zlostavljanja, zlostavljanje, seksualnog Institutional
33    35                  Topic 35: košić, sisačke, potresu Institutional
34    21                 Topic 21: caritasa, ministar, morh     Political
35    19              Topic 19: bozanić, kutleša, đakovačko Institutional
        Change Pct_Change
31 -0.01669720  -32.84224
32 -0.01729648  -50.14169
33 -0.01983640  -55.74825
34 -0.02783600  -61.42743
35 -0.02793484  -56.32724</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-and-key-findings" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Summary and Key Findings</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Debug: show what we have</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"category_prevalence columns:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(category_prevalence), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>category_prevalence columns: Category, Topics, Total_Prevalence </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"category_engagement columns:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(category_engagement), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>category_engagement columns: Category, Mean_Engagement, Total_Prevalence, Engagement_per_Prevalence </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join category data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>category_summary <span class="ot">&lt;-</span> category_prevalence <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(category_engagement, <span class="at">by =</span> <span class="st">"Category"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"category_summary columns:"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(category_summary), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>category_summary columns: Category, Topics, Total_Prevalence.x, Mean_Engagement, Total_Prevalence.y, Engagement_per_Prevalence </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"category_summary rows:"</span>, <span class="fu">nrow</span>(category_summary), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>category_summary rows: 8 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top category by prevalence (handle if column missing)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"Total_Prevalence"</span> <span class="sc">%in%</span> <span class="fu">names</span>(category_summary)) {</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  top_category <span class="ot">&lt;-</span> category_summary <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Total_Prevalence)) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(Total_Prevalence, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  top_cat_name <span class="ot">&lt;-</span> top_category<span class="sc">$</span>Category[<span class="dv">1</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  top_cat_prev <span class="ot">&lt;-</span> <span class="fu">round</span>(top_category<span class="sc">$</span>Total_Prevalence[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  top_cat_name <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  top_cat_prev <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top category by engagement  </span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"Mean_Engagement"</span> <span class="sc">%in%</span> <span class="fu">names</span>(category_summary)) {</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  top_engagement_cat <span class="ot">&lt;-</span> category_summary <span class="sc">%&gt;%</span> </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Mean_Engagement)) <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(Mean_Engagement, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  top_eng_cat_name <span class="ot">&lt;-</span> top_engagement_cat<span class="sc">$</span>Category[<span class="dv">1</span>]</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  top_eng_cat_name <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top category:"</span>, top_cat_name, <span class="st">"with"</span>, top_cat_prev, <span class="st">"% prevalence</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Top category: Unknown with 0 % prevalence</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top engagement category:"</span>, top_eng_cat_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Top engagement category: Devotional </code></pre>
</div>
</div>
<section id="thematic-structure-findings" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="thematic-structure-findings"><span class="header-section-number">8.1</span> Thematic Structure Findings</h2>
<ol type="1">
<li><p><strong>Dominant themes:</strong> The corpus is dominated by Unknown content (0% prevalence)</p></li>
<li><p><strong>Engagement patterns:</strong> Devotional content generates the highest average engagement despite not being the most prevalent</p></li>
<li><p><strong>Actor specialization:</strong> Clear patterns emerge in what different actors talk about</p></li>
<li><p><strong>Platform differences:</strong> Web platforms show more institutional/news content while social platforms show more devotional and community content</p></li>
</ol>
</section>
<section id="topic-model-summary-table" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="topic-model-summary-table"><span class="header-section-number">8.2</span> Topic Model Summary Table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>topic_engagement <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Topic, Label, Category, Prevalence, Weighted_Mean_Engagement) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Prevalence)) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prevalence =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Prevalence),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Mean_Engagement =</span> <span class="fu">round</span>(Weighted_Mean_Engagement, <span class="dv">0</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Topic"</span>, <span class="st">"Label"</span>, <span class="st">"Category"</span>, <span class="st">"Prevalence"</span>, <span class="st">"Mean Engagement"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Topic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Label</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Prevalence</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Engagement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: left;">Topic 16: fra, župi, vlč</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">7.4%</td>
<td style="text-align: right;">63</td>
</tr>
<tr class="even">
<td style="text-align: right;">26</td>
<td style="text-align: left;">Topic 26: amen, gospodine, reče</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">6.5%</td>
<td style="text-align: right;">173</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Topic 4: link, pretplatite, procesija</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">5.8%</td>
<td style="text-align: right;">70</td>
</tr>
<tr class="even">
<td style="text-align: right;">23</td>
<td style="text-align: left;">Topic 23: papa, franjo, vatikanu</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">5.1%</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">Topic 15: kristova, božić, božića</td>
<td style="text-align: left;">Liturgical</td>
<td style="text-align: left;">4.7%</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: left;">Topic 19: bozanić, kutleša, đakovačko</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">4.3%</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">Topic 11: sestara, krunicu, družbe</td>
<td style="text-align: left;">Devotional</td>
<td style="text-align: left;">3.6%</td>
<td style="text-align: right;">243</td>
</tr>
<tr class="even">
<td style="text-align: right;">31</td>
<td style="text-align: left;">Topic 31: vukovar, poginule, brigade</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">3.4%</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Topic 2: matice, festival, manifestacije</td>
<td style="text-align: left;">Youth/Community</td>
<td style="text-align: left;">3.4%</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">Topic 14: slaven, utakmice, utakmica</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">3.4%</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">Topic 13: zlostavljanja, zlostavljanje, seksualnog</td>
<td style="text-align: left;">Institutional</td>
<td style="text-align: left;">3.2%</td>
<td style="text-align: right;">113</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Topic 6: koncerta, publika, jazz</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">3.0%</td>
<td style="text-align: right;">246</td>
</tr>
<tr class="odd">
<td style="text-align: right;">32</td>
<td style="text-align: left;">Topic 32: brak, roditeljima, nacional</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">2.9%</td>
<td style="text-align: right;">130</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td style="text-align: left;">Topic 21: caritasa, ministar, morh</td>
<td style="text-align: left;">Political</td>
<td style="text-align: left;">2.8%</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="odd">
<td style="text-align: right;">28</td>
<td style="text-align: left;">Topic 28: josipu, sente, josipa</td>
<td style="text-align: left;">Social/Ethical</td>
<td style="text-align: left;">2.7%</td>
<td style="text-align: right;">105</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="hypotheses-testing-summary" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="hypotheses-testing-summary"><span class="header-section-number">8.3</span> Hypotheses Testing Summary</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 57%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Hypothesis</th>
<th>Finding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H7: Devotional/liturgical content dominates volume</td>
<td>Examine category prevalence results above</td>
</tr>
<tr class="even">
<td>H8: Political/social content generates disproportionate engagement</td>
<td>Compare engagement efficiency by category</td>
</tr>
<tr class="odd">
<td>H9: Individual priests concentrate on social/political topics</td>
<td>See actor specialization patterns</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="appendix-model-diagnostics" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Appendix: Model Diagnostics</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Topic Model Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Topic Model Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of topics:"</span>, K, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of topics: 35 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Documents:"</span>, <span class="fu">nrow</span>(doc_topics), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Documents: 3710 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Vocabulary size:"</span>, <span class="fu">length</span>(stm_model<span class="sc">$</span>vocab), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Vocabulary size: 21041 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=Croatian_Croatia.utf8  LC_CTYPE=Croatian_Croatia.utf8   
[3] LC_MONETARY=Croatian_Croatia.utf8 LC_NUMERIC=C                     
[5] LC_TIME=Croatian_Croatia.utf8    

time zone: Europe/Zagreb
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] RColorBrewer_1.1-3        pheatmap_1.0.13          
 [3] viridis_0.6.5             viridisLite_0.4.2        
 [5] ggrepel_0.9.6             tidytext_0.4.3           
 [7] stm_1.3.8                 quanteda.textplots_0.96.1
 [9] quanteda.textstats_0.97.2 quanteda_4.3.1           
[11] text2vec_0.6.6            kableExtra_1.4.0         
[13] knitr_1.50                scales_1.4.0             
[15] data.table_1.17.8         lubridate_1.9.4          
[17] forcats_1.0.1             stringr_1.6.0            
[19] dplyr_1.1.4               purrr_1.2.0              
[21] readr_2.1.6               tidyr_1.3.1              
[23] tibble_3.3.0              ggplot2_4.0.1            
[25] tidyverse_2.0.0          

loaded via a namespace (and not attached):
 [1] fastmatch_1.1-6     gtable_0.3.6        xfun_0.54          
 [4] htmlwidgets_1.6.4   lattice_0.22-7      tzdb_0.5.0         
 [7] vctrs_0.6.5         tools_4.5.2         generics_0.1.4     
[10] janeaustenr_1.0.0   tokenizers_0.3.0    pkgconfig_2.0.3    
[13] Matrix_1.7-4        S7_0.2.1            lifecycle_1.0.4    
[16] compiler_4.5.2      farver_2.1.2        textshaping_1.0.4  
[19] RhpcBLASctl_0.23-42 SnowballC_0.7.1     htmltools_0.5.8.1  
[22] yaml_2.3.11         pillar_1.11.1       crayon_1.5.3       
[25] nlme_3.1-168        rsparse_0.5.3       stopwords_2.3      
[28] wordcloud_2.6       tidyselect_1.2.1    digest_0.6.39      
[31] stringi_1.8.7       splines_4.5.2       labeling_0.4.3     
[34] fastmap_1.2.0       grid_4.5.2          cli_3.6.5          
[37] magrittr_2.0.4      dichromat_2.0-0.1   withr_3.0.2        
[40] float_0.3-3         timechange_0.3.0    rmarkdown_2.30     
[43] matrixStats_1.5.0   gridExtra_2.3       mlapi_0.1.1        
[46] hms_1.1.4           evaluate_1.0.5      mgcv_1.9-3         
[49] rlang_1.1.6         Rcpp_1.1.0          nsyllable_1.0.1    
[52] glue_1.8.0          xml2_1.5.1          svglite_2.2.2      
[55] rstudioapi_0.17.1   jsonlite_2.0.0      lgr_0.5.0          
[58] R6_2.6.1            systemfonts_1.3.1  </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>