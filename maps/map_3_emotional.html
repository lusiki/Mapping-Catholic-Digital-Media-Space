<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="DigiKat Project">
<meta name="dcterms.date" content="2026-01-27">

<title>DigiKat Map 3: Emotional Structure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="map_3_emotional_files/libs/clipboard/clipboard.min.js"></script>
<script src="map_3_emotional_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="map_3_emotional_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="map_3_emotional_files/libs/quarto-html/popper.min.js"></script>
<script src="map_3_emotional_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="map_3_emotional_files/libs/quarto-html/anchor.min.js"></script>
<link href="map_3_emotional_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="map_3_emotional_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="map_3_emotional_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="map_3_emotional_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="map_3_emotional_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="map_3_emotional_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="map_3_emotional_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#methodological-overview" id="toc-methodological-overview" class="nav-link" data-scroll-target="#methodological-overview"><span class="header-section-number">1.1</span> Methodological Overview</a></li>
  <li><a href="#corpus-overview" id="toc-corpus-overview" class="nav-link" data-scroll-target="#corpus-overview"><span class="header-section-number">1.2</span> Corpus Overview</a></li>
  </ul></li>
  <li><a href="#analysis-3.1-sentiment-distribution" id="toc-analysis-3.1-sentiment-distribution" class="nav-link" data-scroll-target="#analysis-3.1-sentiment-distribution"><span class="header-section-number">2</span> Analysis 3.1: Sentiment Distribution</a>
  <ul class="collapse">
  <li><a href="#sentiment-by-platform" id="toc-sentiment-by-platform" class="nav-link" data-scroll-target="#sentiment-by-platform"><span class="header-section-number">2.1</span> Sentiment by Platform</a></li>
  <li><a href="#sentiment-by-actor-type" id="toc-sentiment-by-actor-type" class="nav-link" data-scroll-target="#sentiment-by-actor-type"><span class="header-section-number">2.2</span> Sentiment by Actor Type</a></li>
  <li><a href="#sentiment-summary-table" id="toc-sentiment-summary-table" class="nav-link" data-scroll-target="#sentiment-summary-table"><span class="header-section-number">2.3</span> Sentiment Summary Table</a></li>
  <li><a href="#sentiment-and-engagement-relationship" id="toc-sentiment-and-engagement-relationship" class="nav-link" data-scroll-target="#sentiment-and-engagement-relationship"><span class="header-section-number">2.4</span> Sentiment and Engagement Relationship</a></li>
  </ul></li>
  <li><a href="#analysis-3.2-emotional-fingerprinting" id="toc-analysis-3.2-emotional-fingerprinting" class="nav-link" data-scroll-target="#analysis-3.2-emotional-fingerprinting"><span class="header-section-number">3</span> Analysis 3.2: Emotional Fingerprinting</a>
  <ul class="collapse">
  <li><a href="#overall-emotional-profile" id="toc-overall-emotional-profile" class="nav-link" data-scroll-target="#overall-emotional-profile"><span class="header-section-number">3.1</span> Overall Emotional Profile</a></li>
  <li><a href="#emotional-fingerprints-by-actor-type" id="toc-emotional-fingerprints-by-actor-type" class="nav-link" data-scroll-target="#emotional-fingerprints-by-actor-type"><span class="header-section-number">3.2</span> Emotional Fingerprints by Actor Type</a></li>
  <li><a href="#comparative-emotional-profiles" id="toc-comparative-emotional-profiles" class="nav-link" data-scroll-target="#comparative-emotional-profiles"><span class="header-section-number">3.3</span> Comparative Emotional Profiles</a></li>
  <li><a href="#love-ratio-analysis" id="toc-love-ratio-analysis" class="nav-link" data-scroll-target="#love-ratio-analysis"><span class="header-section-number">3.4</span> LOVE Ratio Analysis</a></li>
  <li><a href="#angry-ratio-analysis" id="toc-angry-ratio-analysis" class="nav-link" data-scroll-target="#angry-ratio-analysis"><span class="header-section-number">3.5</span> ANGRY Ratio Analysis</a></li>
  <li><a href="#emotional-profile-table" id="toc-emotional-profile-table" class="nav-link" data-scroll-target="#emotional-profile-table"><span class="header-section-number">3.6</span> Emotional Profile Table</a></li>
  </ul></li>
  <li><a href="#analysis-3.3-controversy-detection" id="toc-analysis-3.3-controversy-detection" class="nav-link" data-scroll-target="#analysis-3.3-controversy-detection"><span class="header-section-number">4</span> Analysis 3.3: Controversy Detection</a>
  <ul class="collapse">
  <li><a href="#controversy-index-distribution" id="toc-controversy-index-distribution" class="nav-link" data-scroll-target="#controversy-index-distribution"><span class="header-section-number">4.1</span> Controversy Index Distribution</a></li>
  <li><a href="#most-controversial-posts" id="toc-most-controversial-posts" class="nav-link" data-scroll-target="#most-controversial-posts"><span class="header-section-number">4.2</span> Most Controversial Posts</a></li>
  <li><a href="#controversy-by-actor-type" id="toc-controversy-by-actor-type" class="nav-link" data-scroll-target="#controversy-by-actor-type"><span class="header-section-number">4.3</span> Controversy by Actor Type</a></li>
  <li><a href="#controversy-rate-by-actor-type" id="toc-controversy-rate-by-actor-type" class="nav-link" data-scroll-target="#controversy-rate-by-actor-type"><span class="header-section-number">4.4</span> Controversy Rate by Actor Type</a></li>
  <li><a href="#controversy-summary-table" id="toc-controversy-summary-table" class="nav-link" data-scroll-target="#controversy-summary-table"><span class="header-section-number">4.5</span> Controversy Summary Table</a></li>
  <li><a href="#controversy-over-time" id="toc-controversy-over-time" class="nav-link" data-scroll-target="#controversy-over-time"><span class="header-section-number">4.6</span> Controversy Over Time</a></li>
  <li><a href="#top-controversial-sources" id="toc-top-controversial-sources" class="nav-link" data-scroll-target="#top-controversial-sources"><span class="header-section-number">4.7</span> Top Controversial Sources</a></li>
  </ul></li>
  <li><a href="#analysis-3.4-emotion-by-sentiment" id="toc-analysis-3.4-emotion-by-sentiment" class="nav-link" data-scroll-target="#analysis-3.4-emotion-by-sentiment"><span class="header-section-number">5</span> Analysis 3.4: Emotion by Sentiment</a>
  <ul class="collapse">
  <li><a href="#sentiment-validation-through-reactions" id="toc-sentiment-validation-through-reactions" class="nav-link" data-scroll-target="#sentiment-validation-through-reactions"><span class="header-section-number">5.1</span> Sentiment Validation Through Reactions</a></li>
  </ul></li>
  <li><a href="#analysis-3.5-emotional-temporal-patterns" id="toc-analysis-3.5-emotional-temporal-patterns" class="nav-link" data-scroll-target="#analysis-3.5-emotional-temporal-patterns"><span class="header-section-number">6</span> Analysis 3.5: Emotional Temporal Patterns</a>
  <ul class="collapse">
  <li><a href="#day-of-week-emotional-patterns" id="toc-day-of-week-emotional-patterns" class="nav-link" data-scroll-target="#day-of-week-emotional-patterns"><span class="header-section-number">6.1</span> Day of Week Emotional Patterns</a></li>
  </ul></li>
  <li><a href="#summary-and-key-findings" id="toc-summary-and-key-findings" class="nav-link" data-scroll-target="#summary-and-key-findings"><span class="header-section-number">7</span> Summary and Key Findings</a>
  <ul class="collapse">
  <li><a href="#summary-table" id="toc-summary-table" class="nav-link" data-scroll-target="#summary-table"><span class="header-section-number">7.1</span> Summary Table</a></li>
  <li><a href="#hypotheses-testing-summary" id="toc-hypotheses-testing-summary" class="nav-link" data-scroll-target="#hypotheses-testing-summary"><span class="header-section-number">7.2</span> Hypotheses Testing Summary</a></li>
  </ul></li>
  <li><a href="#appendix-classification-quality-diagnostics" id="toc-appendix-classification-quality-diagnostics" class="nav-link" data-scroll-target="#appendix-classification-quality-diagnostics"><span class="header-section-number">8</span> Appendix: Classification Quality Diagnostics</a></li>
  <li><a href="#appendix-model-diagnostics" id="toc-appendix-model-diagnostics" class="nav-link" data-scroll-target="#appendix-model-diagnostics"><span class="header-section-number">9</span> Appendix: Model Diagnostics</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DigiKat Map 3: Emotional Structure</h1>
<p class="subtitle lead">Mapping Sentiment and Controversy in Croatian Catholic Digital Media</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>DigiKat Project </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 27, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This document presents <strong>Map 3 of the DigiKat project</strong>, analyzing the emotional structure of Croatian Catholic digital media. The core question driving this analysis is <strong>What emotional register characterizes Croatian Catholic digital communication, and where does controversy emerge?</strong></p>
<section id="methodological-overview" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="methodological-overview"><span class="header-section-number">1.1</span> Methodological Overview</h2>
<p><strong>Sentiment analysis</strong> classifies text into positive, neutral, or negative categories based on the emotional tone of the language used. This automated classification (AUTO_SENTIMENT in the data) provides a high level view of emotional valence across the corpus.</p>
<p><strong>Facebook reactions</strong> offer a more granular view of audience emotional response. Unlike simple likes, reactions (LOVE, WOW, HAHA, SAD, ANGRY) capture distinct emotional states, enabling us to construct emotional fingerprints for different actors and content types.</p>
<p><strong>Key metrics in this analysis:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 33%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>Definition</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sentiment ratio</td>
<td>Positive posts / Negative posts</td>
<td>Higher values indicate more positive tone</td>
</tr>
<tr class="even">
<td>LOVE share</td>
<td>LOVE reactions / Total emotional reactions</td>
<td>Measures affection/appreciation response</td>
</tr>
<tr class="odd">
<td>ANGRY share</td>
<td>ANGRY reactions / Total emotional reactions</td>
<td>Measures anger/outrage response</td>
</tr>
<tr class="even">
<td>Controversy Index</td>
<td>(ANGRY / Interactions) x log(Interactions)</td>
<td>Combines anger intensity with reach</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation guidance:</strong></p>
<ul>
<li>High LOVE share with low ANGRY share indicates devotional, well received content</li>
<li>High ANGRY share may indicate controversial topics or provocative framing</li>
<li>Controversy Index accounts for both intensity (ANGRY ratio) and visibility (interaction volume)</li>
<li>Differences between automated sentiment and audience reactions reveal gaps between intent and reception</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Users/lsikic/Luka C/HKS/Projekti/Digitalni Kat/SHKM/DigiKat/data/merged_comprehensive.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SOURCE_TYPE <span class="sc">!=</span> <span class="st">"tiktok"</span>, <span class="sc">!</span><span class="fu">is.na</span>(SOURCE_TYPE)) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-01-01"</span>) <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2025-12-31"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2021</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2025</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(dta)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data loaded</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data loaded:"</span>, <span class="fu">nrow</span>(dta), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data loaded: 608879 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(dta) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"No data after filtering! Check your date filters."</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>n_posts <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dta)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>n_sources <span class="ot">&lt;-</span> <span class="fu">uniqueN</span>(dta<span class="sc">$</span>FROM)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">min</span>(dta<span class="sc">$</span>DATE), <span class="st">"to"</span>, <span class="fu">max</span>(dta<span class="sc">$</span>DATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ACTOR CLASSIFICATION V4 - SYNCHRONIZED WITH MAP 1</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses hierarchical priority: manual overrides -&gt; secular exclusions -&gt; </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># domain matching -&gt; pattern matching -&gt; lay influencer detection -&gt; default</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># MANUAL OVERRIDES: Highest priority explicit classifications</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>manual_overrides <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Institutional Official"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatska katolička mreža"</span>, <span class="st">"hrvatska katolicka mreza"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"informativna katolička agencija"</span>, <span class="st">"informativna katolicka agencija"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatski katolički radio"</span>, <span class="st">"hrvatski katolicki radio"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatska biskupska konferencija"</span>, <span class="st">"ika"</span>, <span class="st">"hkr"</span>, <span class="st">"hkm"</span>, <span class="st">"hbk"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tiskovni ured hbk"</span>, <span class="st">"radio marija"</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Independent Media"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"laudato tv"</span>, <span class="st">"laudatotv"</span>, <span class="st">"laudato.tv"</span>, <span class="st">"laudato.hr"</span>, <span class="st">"laudato"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bitno.net"</span>, <span class="st">"bitno net"</span>, <span class="st">"glas koncila"</span>, <span class="st">"glaskoncila"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nova eva"</span>, <span class="st">"nova-eva"</span>, <span class="st">"verbum"</span>, <span class="st">"totus tuus"</span>, <span class="st">"totus-tuus"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"katolički tjednik"</span>, <span class="st">"katolicki tjednik"</span>, <span class="st">"kršćanska sadašnjost"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"krscanska sadasnjost"</span>, <span class="st">"mir i dobro"</span>, <span class="st">"svjetlo riječi"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"novizivot.net"</span>, <span class="st">"novi zivot"</span>, <span class="st">"novi život"</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charismatic Communities"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"božja pobjeda"</span>, <span class="st">"bozja pobjeda"</span>, <span class="st">"bozjapobjeda"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"muževni budite"</span>, <span class="st">"muzevni budite"</span>, <span class="st">"muzevnibudite"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"srce isusovo"</span>, <span class="st">"srceisuovo"</span>, <span class="st">"cenacolo"</span>, <span class="st">"comunità cenacolo"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"duhovna obnova"</span>, <span class="st">"molitvena snaga"</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dom molitve slavonski brod"</span>, <span class="st">"dom molitve"</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"molitvena zajednica sv. josipa"</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Lay Influencers"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"katolička obitelj"</span>, <span class="st">"katolicka obitelj"</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"marija majka isusova"</span>, <span class="st">"božanske molitve"</span>, <span class="st">"bozanske molitve"</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"moćne molitve tv"</span>, <span class="st">"mocne molitve tv"</span>, <span class="st">"moćne molitve"</span>, <span class="st">"mocne molitve"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"katoličke molitve"</span>, <span class="st">"katolicke molitve"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pulherissimus"</span>, <span class="st">"pod smokvom"</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrana za dušu"</span>, <span class="st">"hrana za dusu"</span>,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"добровољци"</span>, <span class="st">"miletić marin"</span>, <span class="st">"miletic marin"</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dijete vjere"</span>, <span class="st">"vjera"</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kapljice ljubavi božje"</span>, <span class="st">"kapljice ljubavi bozje"</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kršćanstvo"</span>, <span class="st">"krscanstvo"</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"jutarnja molitva duhu svetom"</span>, <span class="st">"blago molitve"</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"biblija krunice molitve"</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"molitve bogu"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"vojnik sreće"</span>, <span class="st">"vojnik srece"</span>, <span class="st">"duhovne poruke i inspiracija"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kes duhovni kutak"</span>, <span class="st">"duhovni kutak"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"molitve.hr"</span>, <span class="st">"duhovniportal.com"</span>, <span class="st">"duhovniportal"</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Diocesan"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zagrebačka nadbiskupija"</span>, <span class="st">"zagrebacka nadbiskupija"</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sisačka biskupija"</span>, <span class="st">"sisacka biskupija"</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"župa šurkovac"</span>, <span class="st">"zupa surkovac"</span>, <span class="st">"sveta mati slobode"</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"župa sv. ilije proroka metković"</span>, <span class="st">"zupa sv. ilije proroka metkovic"</span>,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"župa uznesenja bdm"</span>, <span class="st">"zupa uznesenja bdm"</span>, <span class="st">"župa uznesenja bdm - stenjevec"</span>,</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"šibenska biskupija"</span>, <span class="st">"sibenska biskupija"</span>,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"požeška biskupija"</span>, <span class="st">"pozeskа biskupija"</span>,</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dubrovacka biskupija"</span>, <span class="st">"dubrovačka biskupija"</span>,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dubrovacka-biskupija.hr"</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zupa tramosnica"</span>, <span class="st">"župa tramošnica"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"župa sv. vida"</span>, <span class="st">"zupa sv. vida"</span>, <span class="st">"župa sv. vida - petruševec"</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Youth Organizations"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"susret hrvatske katoličke mladeži"</span>, <span class="st">"susret hrvatske katolicke mladezi"</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"shkm požega"</span>, <span class="st">"shkm pozega"</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Academic"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatsko katoličko sveučilište"</span>, <span class="st">"hrvatsko katolicko sveuciliste"</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"universitas studiorum catholica croatica"</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="co"># SECULAR MEDIA EXCLUSIONS: Always classify as Other</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>secular_exclusions <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># National portals (with and without .hr)</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>  <span class="st">"slobodnadalmacija"</span>, <span class="st">"slobodnadalmacija.hr"</span>, </span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vecernji"</span>, <span class="st">"vecernji.hr"</span>, </span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  <span class="st">"index.hr"</span>, <span class="st">"index"</span>,</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jutarnji"</span>, <span class="st">"jutarnji.hr"</span>, </span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  <span class="st">"novilist"</span>, <span class="st">"novilist.hr"</span>,</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">"24sata"</span>, <span class="st">"24sata.hr"</span>,</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">"direktno"</span>, <span class="st">"direktno.hr"</span>,</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nacional"</span>, <span class="st">"nacional.hr"</span>, </span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tportal"</span>, <span class="st">"tportal.hr"</span>,</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dnevnik.hr"</span>, <span class="st">"dnevnik"</span>, </span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hrt.hr"</span>, <span class="st">"hrt"</span>, </span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n1info"</span>, <span class="st">"n1info.hr"</span>, <span class="st">"n1"</span>,</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rtl.hr"</span>, <span class="st">"rtl"</span>, </span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>  <span class="st">"net.hr"</span>, </span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>  <span class="st">"telegram.hr"</span>, <span class="st">"telegram"</span>, </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>  <span class="st">"story.hr"</span>, <span class="st">"express.hr"</span>, <span class="st">"express"</span>, <span class="st">"advance.hr"</span>,</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regional portals</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  <span class="st">"glasistre"</span>, <span class="st">"glasistre.hr"</span>,</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dnevno.hr"</span>, <span class="st">"dnevno"</span>, </span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>  <span class="st">"prigorski"</span>, <span class="st">"glas-slavonije"</span>, <span class="st">"glas slavonije"</span>,</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  <span class="st">"croativ"</span>, <span class="st">"oluja.info"</span>, </span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>  <span class="st">"maxportal"</span>, <span class="st">"maxportal.hr"</span>,</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hkv.hr"</span>, <span class="st">"icv.hr"</span>, <span class="st">"novosti.hr"</span>, <span class="st">"7dnevno"</span>, <span class="st">"mnovine"</span>, </span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sjever.hr"</span>, <span class="st">"dulist.hr"</span>, <span class="st">"pozega.eu"</span>, <span class="st">"sibenik.in"</span>,</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ferata.hr"</span>, <span class="st">"epodravina"</span>, <span class="st">"glasgacke"</span>, <span class="st">"radio-zlatar"</span>, </span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  <span class="st">"medjimurski.hr"</span>, <span class="st">"sbperiskop"</span>, <span class="st">"zagorje-international"</span>,</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pozeski"</span>, <span class="st">"novine.hr"</span>, <span class="st">"dubrovnikinsider"</span>, <span class="st">"regionalni"</span>, </span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>  <span class="st">"leportale"</span>, <span class="st">"varazdinske-vijesti"</span>, <span class="st">"radionasice"</span>, </span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>  <span class="st">"brodportal"</span>, <span class="st">"ljportal"</span>, <span class="st">"dubrovnikportal"</span>, <span class="st">"01portal"</span>,</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tomislavnews"</span>, <span class="st">"hia.com.hr"</span>, <span class="st">"portalnovosti"</span>, <span class="st">"antenazadar"</span>,</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dalmacijanews"</span>, <span class="st">"zadarskilist"</span>, <span class="st">"medjimurjepress"</span>, </span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>  <span class="st">"zagreb.info"</span>, <span class="st">"034portal"</span>, <span class="st">"057info"</span>, <span class="st">"cityportal"</span>,</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>  <span class="st">"klikaj.hr"</span>, <span class="st">"lika-online"</span>, <span class="st">"ploce.com"</span>, <span class="st">"sbonline"</span>, </span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>  <span class="st">"narod.hr"</span>, <span class="st">"infokiosk"</span>, <span class="st">"hrsvijet"</span>, <span class="st">"tomislavcity"</span>, </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vrisak.info"</span>, <span class="st">"dalmacijadanas"</span>, <span class="st">"dalmacijadanas.hr"</span>,</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>  <span class="st">"morski.hr"</span>, <span class="st">"zagreb.hr"</span>, <span class="st">"osijek031"</span>, <span class="st">"rijeka.hr"</span>, <span class="st">"zadar.hr"</span>,</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>  <span class="st">"zupanjac.net"</span>, <span class="st">"zupanjac"</span>, </span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dalmatinskiportal.hr"</span>, <span class="st">"dalmatinskiportal"</span>,</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>  <span class="st">"campaign-archive.com"</span>,</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Forums and aggregators</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>  <span class="st">"forum.hr"</span>, <span class="st">"reddit"</span>, <span class="st">"anonymous_user"</span>, <span class="st">"komentari"</span>, <span class="st">"bug.hr"</span>,</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Entertainment and other</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="st">"inmemoriam"</span>, <span class="st">"magicus.info"</span>, <span class="st">"book.hr"</span>, <span class="st">"mojzagreb.info"</span>, </span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  <span class="st">"skole.hr"</span>, <span class="st">"tvprofil"</span>, <span class="st">"priznajem.hr"</span>, <span class="st">"dragovoljac.com"</span>, </span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>  <span class="st">"croatia"</span>, <span class="st">"wikipedia"</span>,</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>  <span class="st">"facebook.com"</span>, <span class="st">"youtube.com"</span>, <span class="st">"instagram.com"</span>, <span class="st">"twitter.com"</span>,</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Government and administrative</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>  <span class="st">"županija"</span>, <span class="st">"zupanija"</span>, <span class="st">"grad "</span>, <span class="st">"opcina"</span>, <span class="st">"općina"</span>,</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Non-Catholic religious groups</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kršćanska proročka crkva"</span>, <span class="st">"krscanska prorocka crkva"</span>,</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>  <span class="st">"crkva svemogućeg boga"</span>, <span class="st">"crkva svemoguceg boga"</span>,</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jehovini svjedoci"</span>, <span class="st">"adventisti"</span>, <span class="st">"baptisti"</span>, <span class="st">"pentekostalna"</span>,</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Political parties</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  <span class="st">"domovinski pokret"</span>, <span class="st">"hdz"</span>, <span class="st">"sdp"</span>, <span class="st">"most"</span>, <span class="st">"možemo"</span>, <span class="st">"mozemo"</span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>classify_actor_v4 <span class="ot">&lt;-</span> <span class="cf">function</span>(from_value, <span class="at">url_value =</span> <span class="cn">NA</span>, <span class="at">platform_value =</span> <span class="cn">NA</span>) {</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>  from_lower <span class="ot">&lt;-</span> <span class="fu">tolower</span>(from_value)</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>  url_lower <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(url_value), <span class="st">""</span>, url_value))</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>  platform_lower <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(platform_value), <span class="st">""</span>, platform_value))</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">paste</span>(from_lower, url_lower)</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Helper function for matching</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>  match_any <span class="ot">&lt;-</span> <span class="cf">function</span>(patterns, text) {</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any</span>(<span class="fu">sapply</span>(patterns, <span class="cf">function</span>(p) <span class="fu">grepl</span>(p, text, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PRIORITY 1: Manual overrides (highest priority)</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (actor_type <span class="cf">in</span> <span class="fu">names</span>(manual_overrides)) {</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">match_any</span>(manual_overrides[[actor_type]], from_lower)) {</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(actor_type)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PRIORITY 2: Secular exclusions</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">match_any</span>(secular_exclusions, combined)) {</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PRIORITY 3: Domain-based classification</span></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>  institutional_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hkm.hr"</span>, <span class="st">"ika.hkm.hr"</span>, <span class="st">"hkr.hkm.hr"</span>, <span class="st">"hbk.hr"</span>)</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(institutional_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Institutional Official"</span>)</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>  diocesan_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zg-nadbiskupija.hr"</span>, <span class="st">"biskupija-varazdinska.hr"</span>, <span class="st">"djos.hr"</span>, </span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">"biskupija-sj.hr"</span>, <span class="st">"rzs.hr"</span>, <span class="st">"rkc-sisak.hr"</span>, <span class="st">"zadarskanadbiskupija.hr"</span>,</span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gospicko-senjska-biskupija.hr"</span>, <span class="st">"nadbiskupija-split.com"</span>,</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dubrovacka-biskupija.hr"</span>, <span class="st">"porec-biskupija.hr"</span>, <span class="st">"biskupija-kk.hr"</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(diocesan_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Diocesan"</span>)</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>  independent_media_domains <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"laudato.hr"</span>, <span class="st">"laudato.tv"</span>, <span class="st">"bitno.net"</span>, <span class="st">"glaskoncila.hr"</span>, </span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nova-eva.com"</span>, <span class="st">"verbum.hr"</span>, <span class="st">"ks.hr"</span>, <span class="st">"novizivot.net"</span></span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(independent_media_domains, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, url_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Independent Media"</span>)</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PRIORITY 4: Pattern-based classification</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for parish patterns (covers missing diacritics)</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>  is_parish <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^župa|^zupa|župi|zupi|- župa|- zupa"</span>, from_lower, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">||</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>               <span class="fu">grepl</span>(<span class="st">"parish"</span>, from_lower, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>  diocesan_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"nadbiskupija"</span>, <span class="st">"biskupija"</span>)</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (is_parish <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">sapply</span>(diocesan_names, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Diocesan"</span>)</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Religious orders</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>  religious_orders <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">"franjevci"</span>, <span class="st">"franjevački"</span>, <span class="st">"franjevacki"</span>, <span class="st">"ofm"</span>,</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>    <span class="st">"isusovci"</span>, <span class="st">"družba isusova"</span>, <span class="st">"druzba isusova"</span>,</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dominikanci"</span>, <span class="st">"dominikanski"</span>,</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>    <span class="st">"salezijanci"</span>, <span class="st">"salezijanski"</span>, <span class="st">"sdb"</span>,</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">"karmelićani"</span>, <span class="st">"karmelicani"</span>, <span class="st">"karmel"</span>,</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"benediktinci"</span>, <span class="st">"benediktinski"</span>, <span class="st">"osb"</span>,</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kapucini"</span>, <span class="st">"kapucinski"</span>, <span class="st">"ofmcap"</span>,</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pavlini"</span>, <span class="st">"pavlinski"</span>, <span class="st">"trapisti"</span>, <span class="st">"cisterciti"</span>,</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sestre milosrdnice"</span>, <span class="st">"uršulinke"</span>, <span class="st">"klarise"</span>,</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"službenice milosrđa"</span>, <span class="st">"kćeri božje ljubavi"</span>, <span class="st">"kceri bozje ljubavi"</span></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(religious_orders, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Religious Orders"</span>)</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Charismatic communities</span></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>  charismatic <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"molitvena zajednica"</span>, <span class="st">"karizmatska"</span>, <span class="st">"cenacolo"</span>,</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"emmanuel community"</span>, <span class="st">"emmanuel zajednica"</span>, <span class="st">"taize"</span>,</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neokatekumenski"</span>, <span class="st">"neokatekumenska"</span>, <span class="st">"kursiljo"</span>,</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fokolari"</span>, <span class="st">"fokolarini"</span>, <span class="st">"komunija i oslobođenje"</span>,</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dom molitve"</span>, <span class="st">"kuća molitve"</span>, <span class="st">"kuca molitve"</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(charismatic, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Charismatic Communities"</span>)</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual priests (check prefix at start of name)</span></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>  priest_prefixes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fra "</span>, <span class="st">"don "</span>, <span class="st">"vlč."</span>, <span class="st">"vlc."</span>, <span class="st">"msgr."</span>, <span class="st">"mons."</span>,</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"o. "</span>, <span class="st">"pater "</span>, <span class="st">"preč."</span>, <span class="st">"prec."</span>)</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (prefix <span class="cf">in</span> priest_prefixes) {</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">startsWith</span>(from_lower, prefix)) <span class="fu">return</span>(<span class="st">"Individual Priests"</span>)</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"svećenik|svecenik|župnik|zupnik"</span>, from_lower)) {</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Individual Priests"</span>)</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Youth organizations</span></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>  youth <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"frama"</span>, <span class="st">"shkm"</span>, <span class="st">"katolička mladež"</span>, <span class="st">"katolicka mladez"</span>,</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ministranti"</span>, <span class="st">"mladifra"</span>, <span class="st">"mladi fra"</span>, <span class="st">"kaem"</span>,</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sveučilišna kapelanija"</span>, <span class="st">"studentska kapelanija"</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(youth, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Youth Organizations"</span>)</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Academic</span></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>  academic <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"unicath"</span>, <span class="st">"katolički bogoslovni fakultet"</span>, <span class="st">"kbf"</span>,</span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"teologija"</span>, <span class="st">"filozofski fakultet družbe isusove"</span>, <span class="st">"hks.hr"</span>,</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hrvatsko katoličko sveučilište"</span>, <span class="st">"hku"</span></span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">sapply</span>(academic, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))) {</span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Academic"</span>)</span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PRIORITY 5: Lay influencer detection (platform-aware)</span></span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>  lay_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>    <span class="st">"vjera"</span>, <span class="st">"molitva"</span>, <span class="st">"molitve"</span>, <span class="st">"isus"</span>, <span class="st">"krist"</span>, <span class="st">"gospa"</span>, <span class="st">"marija"</span>,</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"duhovnost"</span>, <span class="st">"duhovna"</span>, <span class="st">"duhovni"</span>, <span class="st">"biblija"</span>, <span class="st">"psalm"</span>, <span class="st">"blagoslov"</span>,</span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"krunica"</span>, <span class="st">"rozarij"</span>, <span class="st">"katolička obitelj"</span>, <span class="st">"evanđelje"</span>, <span class="st">"evandelje"</span></span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>  lay_exclude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">".hr"</span>, <span class="st">".net"</span>, <span class="st">".com"</span>, <span class="st">"portal"</span>, <span class="st">"vijesti"</span>, <span class="st">"news"</span>, <span class="st">"radio"</span>)</span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>  is_likely_social <span class="ot">&lt;-</span> platform_lower <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"facebook"</span>, <span class="st">"instagram"</span>, <span class="st">"youtube"</span>, <span class="st">"twitter"</span>) <span class="sc">||</span></span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.[a-z]{2,4}$"</span>, from_lower)</span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>  has_devotional <span class="ot">&lt;-</span> <span class="fu">any</span>(<span class="fu">sapply</span>(lay_keywords, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>  has_media_marker <span class="ot">&lt;-</span> <span class="fu">any</span>(<span class="fu">sapply</span>(lay_exclude, <span class="cf">function</span>(x) <span class="fu">grepl</span>(x, from_lower, <span class="at">fixed =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (is_likely_social <span class="sc">&amp;&amp;</span> has_devotional <span class="sc">&amp;&amp;</span> <span class="sc">!</span>has_media_marker) {</span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Lay Influencers"</span>)</span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply classification</span></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>dta[, ACTOR_TYPE <span class="sc">:</span><span class="er">=</span> <span class="fu">mapply</span>(classify_actor_v4, FROM, URL, SOURCE_TYPE)]</span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify classification</span></span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ACTOR_TYPE class:"</span>, <span class="fu">class</span>(dta<span class="sc">$</span>ACTOR_TYPE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ACTOR_TYPE class: character </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ACTOR_TYPE distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ACTOR_TYPE distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(dta<span class="sc">$</span>ACTOR_TYPE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
               Academic Charismatic Communities                Diocesan 
                    671                    1282                   13841 
      Independent Media  Institutional Official         Lay Influencers 
                  31401                   62744                   28451 
                  Other        Religious Orders     Youth Organizations 
                 468760                    1677                      52 </code></pre>
</div>
</div>
</section>
<section id="corpus-overview" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="corpus-overview"><span class="header-section-number">1.2</span> Corpus Overview</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Total posts"</span>, <span class="st">"Unique sources"</span>, <span class="st">"Date range"</span>, <span class="st">"Platforms"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Posts with sentiment"</span>, <span class="st">"Posts with Facebook reactions"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(n_posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(n_sources, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    date_range,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">unique</span>(dta<span class="sc">$</span>SOURCE_TYPE), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(dta<span class="sc">$</span>AUTO_SENTIMENT)), <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">sum</span>(dta<span class="sc">$</span>SOURCE_TYPE <span class="sc">==</span> <span class="st">"facebook"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dta<span class="sc">$</span>LOVE_COUNT)), <span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total posts</td>
<td style="text-align: left;">608,879</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unique sources</td>
<td style="text-align: left;">16,426</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date range</td>
<td style="text-align: left;">2021-01-01 to 2025-12-31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Platforms</td>
<td style="text-align: left;">web, facebook, twitter, comment, youtube, forum, reddit, instagram</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posts with sentiment</td>
<td style="text-align: left;">608,879</td>
</tr>
<tr class="even">
<td style="text-align: left;">Posts with Facebook reactions</td>
<td style="text-align: left;">68,771</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="analysis-3.1-sentiment-distribution" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Analysis 3.1: Sentiment Distribution</h1>
<p>Sentiment analysis classifies each post as positive, neutral, or negative based on linguistic features. This section examines how sentiment varies across the corpus, platforms, and actor types.</p>
<p><strong>Reading the charts:</strong></p>
<ul>
<li><strong>Overall distribution</strong> shows the baseline emotional tone of the corpus</li>
<li><strong>Platform comparison</strong> reveals how different media afford different emotional registers</li>
<li><strong>Actor comparison</strong> identifies which communicators tend toward more positive or negative framing</li>
<li><strong>Positivity ratio</strong> (positive/negative) summarizes relative emotional valence</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sentiment_dist <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT), .(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> .N</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> AUTO_SENTIMENT][<span class="fu">order</span>(<span class="sc">-</span>Count)]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>sentiment_dist[, Percentage <span class="sc">:</span><span class="er">=</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sentiment_dist, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(AUTO_SENTIMENT, <span class="sc">-</span>Count), <span class="at">y =</span> Count, <span class="at">fill =</span> AUTO_SENTIMENT)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, <span class="fu">format</span>(Count, <span class="at">big.mark =</span> <span class="st">","</span>), Percentage)), </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sentiment_colors) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Overall Sentiment Distribution"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distribution of automated sentiment classification across corpus"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Posts"</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/sentiment-overall-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="sentiment-by-platform" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sentiment-by-platform"><span class="header-section-number">2.1</span> Sentiment by Platform</h2>
<p>Different platforms may encourage different emotional registers due to their affordances, audience expectations, and content formats.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sentiment_platform <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT), .(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> .N</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> .(SOURCE_TYPE, AUTO_SENTIMENT)]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sentiment_platform[, Total <span class="sc">:</span><span class="er">=</span> <span class="fu">sum</span>(Count), by <span class="ot">=</span> SOURCE_TYPE]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sentiment_platform[, Percentage <span class="sc">:</span><span class="er">=</span> Count <span class="sc">/</span> Total <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sentiment_platform, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(SOURCE_TYPE, Total), <span class="at">y =</span> Percentage, <span class="at">fill =</span> AUTO_SENTIMENT)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Percentage)), </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sentiment_colors) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sentiment Distribution by Platform"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Share of positive, neutral, and negative content per platform"</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage of Posts"</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sentiment"</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/sentiment-by-platform-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sentiment-by-actor-type" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sentiment-by-actor-type"><span class="header-section-number">2.2</span> Sentiment by Actor Type</h2>
<p>Actor types may have characteristic emotional registers reflecting their institutional roles, communication strategies, and target audiences.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sentiment_actor <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT), .(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> .N</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> .(ACTOR_TYPE, AUTO_SENTIMENT)]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>sentiment_actor[, Total <span class="sc">:</span><span class="er">=</span> <span class="fu">sum</span>(Count), by <span class="ot">=</span> ACTOR_TYPE]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sentiment_actor[, Percentage <span class="sc">:</span><span class="er">=</span> Count <span class="sc">/</span> Total <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>actor_order <span class="ot">&lt;-</span> sentiment_actor[AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"positive"</span>][<span class="fu">order</span>(<span class="sc">-</span>Percentage)]<span class="sc">$</span>ACTOR_TYPE</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sentiment_actor, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(ACTOR_TYPE, <span class="at">levels =</span> <span class="fu">rev</span>(actor_order)), </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> Percentage, <span class="at">fill =</span> AUTO_SENTIMENT)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sentiment_colors) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sentiment Distribution by Actor Type"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ordered by share of positive content"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage of Posts"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sentiment"</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/sentiment-by-actor-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sentiment-summary-table" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sentiment-summary-table"><span class="header-section-number">2.3</span> Sentiment Summary Table</h2>
<p>The <strong>Positivity Ratio</strong> divides positive posts by negative posts. Values above 1 indicate more positive than negative content; higher values indicate a more positive overall tone.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sentiment_summary <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT), .(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_Posts =</span> .N,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive =</span> <span class="fu">sum</span>(AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"positive"</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Neutral =</span> <span class="fu">sum</span>(AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"neutral"</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Negative =</span> <span class="fu">sum</span>(AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"negative"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> ACTOR_TYPE]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>sentiment_summary[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive_Pct =</span> Positive <span class="sc">/</span> Total_Posts <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Neutral_Pct =</span> Neutral <span class="sc">/</span> Total_Posts <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Negative_Pct =</span> Negative <span class="sc">/</span> Total_Posts <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positivity_Ratio =</span> Positive <span class="sc">/</span> (Negative <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>sentiment_summary[<span class="fu">order</span>(<span class="sc">-</span>Positive_Pct)] <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Posts =</span> <span class="fu">format</span>(Total_Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Positive_Pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Positive_Pct),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neutral_Pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Neutral_Pct),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Negative_Pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Negative_Pct),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Positivity_Ratio =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, Positivity_Ratio)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ACTOR_TYPE, Total_Posts, Positive_Pct, Neutral_Pct, Negative_Pct, Positivity_Ratio) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actor Type"</span>, <span class="st">"Total Posts"</span>, <span class="st">"Positive %"</span>, <span class="st">"Neutral %"</span>, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Negative %"</span>, <span class="st">"Positivity Ratio"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actor Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Posts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Positive %</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Neutral %</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Negative %</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Positivity Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Youth Organizations</td>
<td style="text-align: left;">52</td>
<td style="text-align: left;">94.2%</td>
<td style="text-align: left;">5.8%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">490.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">28,451</td>
<td style="text-align: left;">64.2%</td>
<td style="text-align: left;">18.7%</td>
<td style="text-align: left;">17.1%</td>
<td style="text-align: left;">3.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">671</td>
<td style="text-align: left;">54.8%</td>
<td style="text-align: left;">27.6%</td>
<td style="text-align: left;">17.6%</td>
<td style="text-align: left;">3.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">13,841</td>
<td style="text-align: left;">53.9%</td>
<td style="text-align: left;">29.7%</td>
<td style="text-align: left;">16.4%</td>
<td style="text-align: left;">3.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Religious Orders</td>
<td style="text-align: left;">1,677</td>
<td style="text-align: left;">52.4%</td>
<td style="text-align: left;">30.9%</td>
<td style="text-align: left;">16.7%</td>
<td style="text-align: left;">3.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">31,401</td>
<td style="text-align: left;">51.4%</td>
<td style="text-align: left;">26.0%</td>
<td style="text-align: left;">22.6%</td>
<td style="text-align: left;">2.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">62,744</td>
<td style="text-align: left;">49.0%</td>
<td style="text-align: left;">27.8%</td>
<td style="text-align: left;">23.2%</td>
<td style="text-align: left;">2.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">468,760</td>
<td style="text-align: left;">45.5%</td>
<td style="text-align: left;">23.4%</td>
<td style="text-align: left;">31.0%</td>
<td style="text-align: left;">1.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Charismatic Communities</td>
<td style="text-align: left;">1,282</td>
<td style="text-align: left;">36.5%</td>
<td style="text-align: left;">35.3%</td>
<td style="text-align: left;">28.2%</td>
<td style="text-align: left;">1.30</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="sentiment-and-engagement-relationship" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sentiment-and-engagement-relationship"><span class="header-section-number">2.4</span> Sentiment and Engagement Relationship</h2>
<p>Does emotional tone affect audience engagement? This analysis examines whether positive, neutral, or negative content generates different levels of interaction.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sentiment_engagement <span class="ot">&lt;-</span> dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(INTERACTIONS), .(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_Interactions =</span> <span class="fu">mean</span>(INTERACTIONS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median_Interactions =</span> <span class="fu">median</span>(INTERACTIONS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_Interactions =</span> <span class="fu">sum</span>(INTERACTIONS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> .N</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> AUTO_SENTIMENT]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sentiment_engagement, <span class="fu">aes</span>(<span class="at">x =</span> AUTO_SENTIMENT, <span class="at">y =</span> Mean_Interactions, <span class="at">fill =</span> AUTO_SENTIMENT)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, Mean_Interactions)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sentiment_colors) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Engagement by Sentiment"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Interactions"</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dta[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT) <span class="sc">&amp;</span> INTERACTIONS <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> INTERACTIONS <span class="sc">&lt;</span> <span class="fu">quantile</span>(INTERACTIONS, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)], </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> AUTO_SENTIMENT, <span class="at">y =</span> INTERACTIONS, <span class="at">fill =</span> AUTO_SENTIMENT)) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> sentiment_colors) <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Engagement Distribution by Sentiment"</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Log scale, top 1% outliers excluded"</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Interactions (log scale)"</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/sentiment-engagement-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-3.2-emotional-fingerprinting" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis 3.2: Emotional Fingerprinting</h1>
<p>Facebook reactions provide granular emotional data beyond simple sentiment. Each reaction type captures a distinct emotional response:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 38%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Reaction</th>
<th>Emotional Meaning</th>
<th>Content Association</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LOVE</td>
<td>Deep affection, strong appreciation</td>
<td>Devotional, inspirational</td>
</tr>
<tr class="even">
<td>WOW</td>
<td>Surprise, amazement</td>
<td>News, revelations</td>
</tr>
<tr class="odd">
<td>HAHA</td>
<td>Amusement, humor</td>
<td>Light content, satire</td>
</tr>
<tr class="even">
<td>SAD</td>
<td>Sorrow, empathy</td>
<td>Death notices, suffering</td>
</tr>
<tr class="odd">
<td>ANGRY</td>
<td>Outrage, disagreement</td>
<td>Controversy, injustice</td>
</tr>
</tbody>
</table>
<p>By analyzing the mix of reactions each actor type receives, we can construct <strong>emotional fingerprints</strong> that characterize their audience relationships.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fb_data <span class="ot">&lt;-</span> dta[SOURCE_TYPE <span class="sc">==</span> <span class="st">"facebook"</span> <span class="sc">&amp;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>               <span class="sc">!</span><span class="fu">is.na</span>(LOVE_COUNT) <span class="sc">&amp;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               <span class="sc">!</span><span class="fu">is.na</span>(INTERACTIONS) <span class="sc">&amp;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               INTERACTIONS <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Facebook posts with reaction data:"</span>, <span class="fu">nrow</span>(fb_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Facebook posts with reaction data: 63843 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  fb_data[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE_RATIO =</span> LOVE_COUNT <span class="sc">/</span> INTERACTIONS,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">WOW_RATIO =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(WOW_COUNT), <span class="dv">0</span>, WOW_COUNT) <span class="sc">/</span> INTERACTIONS,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">HAHA_RATIO =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(HAHA_COUNT), <span class="dv">0</span>, HAHA_COUNT) <span class="sc">/</span> INTERACTIONS,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAD_RATIO =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(SAD_COUNT), <span class="dv">0</span>, SAD_COUNT) <span class="sc">/</span> INTERACTIONS,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY_RATIO =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(ANGRY_COUNT), <span class="dv">0</span>, ANGRY_COUNT) <span class="sc">/</span> INTERACTIONS,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">LIKE_RATIO =</span> LIKE_COUNT <span class="sc">/</span> INTERACTIONS</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  )]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  fb_data[, Total_Reactions <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(LOVE_COUNT), <span class="dv">0</span>, LOVE_COUNT) <span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">fifelse</span>(<span class="fu">is.na</span>(WOW_COUNT), <span class="dv">0</span>, WOW_COUNT) <span class="sc">+</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">fifelse</span>(<span class="fu">is.na</span>(HAHA_COUNT), <span class="dv">0</span>, HAHA_COUNT) <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">fifelse</span>(<span class="fu">is.na</span>(SAD_COUNT), <span class="dv">0</span>, SAD_COUNT) <span class="sc">+</span> </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">fifelse</span>(<span class="fu">is.na</span>(ANGRY_COUNT), <span class="dv">0</span>, ANGRY_COUNT)]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE_SHARE =</span> LOVE_COUNT <span class="sc">/</span> Total_Reactions,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">WOW_SHARE =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(WOW_COUNT), <span class="dv">0</span>, WOW_COUNT) <span class="sc">/</span> Total_Reactions,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">HAHA_SHARE =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(HAHA_COUNT), <span class="dv">0</span>, HAHA_COUNT) <span class="sc">/</span> Total_Reactions,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAD_SHARE =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(SAD_COUNT), <span class="dv">0</span>, SAD_COUNT) <span class="sc">/</span> Total_Reactions,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY_SHARE =</span> <span class="fu">fifelse</span>(<span class="fu">is.na</span>(ANGRY_COUNT), <span class="dv">0</span>, ANGRY_COUNT) <span class="sc">/</span> Total_Reactions</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  )]</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overall-emotional-profile" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="overall-emotional-profile"><span class="header-section-number">3.1</span> Overall Emotional Profile</h2>
<p>The overall distribution of emotional reactions reveals the dominant emotional register of Croatian Catholic Facebook content.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  emotion_totals <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Emotion =</span> <span class="fu">c</span>(<span class="st">"LOVE"</span>, <span class="st">"WOW"</span>, <span class="st">"HAHA"</span>, <span class="st">"SAD"</span>, <span class="st">"ANGRY"</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">c</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(fb_data<span class="sc">$</span>LOVE_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(fb_data<span class="sc">$</span>WOW_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(fb_data<span class="sc">$</span>HAHA_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(fb_data<span class="sc">$</span>SAD_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(fb_data<span class="sc">$</span>ANGRY_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  emotion_totals[, Percentage <span class="sc">:</span><span class="er">=</span> Total <span class="sc">/</span> <span class="fu">sum</span>(Total) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emotion_totals, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Emotion, <span class="sc">-</span>Total), <span class="at">y =</span> Total, <span class="at">fill =</span> Emotion)) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, <span class="fu">format</span>(Total, <span class="at">big.mark =</span> <span class="st">","</span>), Percentage)), </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> emotion_colors) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Overall Emotional Reaction Distribution"</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Total Facebook reactions by type across all Catholic content"</span>,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Total Reactions"</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No Facebook reaction data available.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-overall-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="emotional-fingerprints-by-actor-type" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="emotional-fingerprints-by-actor-type"><span class="header-section-number">3.2</span> Emotional Fingerprints by Actor Type</h2>
<p>Each actor type has a characteristic mix of emotional reactions. These fingerprints reveal how audiences emotionally engage with different types of Catholic communicators.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  actor_emotions <span class="ot">&lt;-</span> fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">WOW =</span> <span class="fu">mean</span>(WOW_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">HAHA =</span> <span class="fu">mean</span>(HAHA_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAD =</span> <span class="fu">mean</span>(SAD_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> ACTOR_TYPE]</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  actor_emotions_long <span class="ot">&lt;-</span> actor_emotions <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Posts) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>ACTOR_TYPE, <span class="at">names_to =</span> <span class="st">"Emotion"</span>, <span class="at">values_to =</span> <span class="st">"Share"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(actor_emotions_long, <span class="fu">aes</span>(<span class="at">x =</span> Emotion, <span class="at">y =</span> Share, <span class="at">fill =</span> Emotion)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>ACTOR_TYPE, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> emotion_colors) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Emotional Fingerprints by Actor Type"</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean share of each reaction type among emotional reactions"</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Share of Emotional Reactions (%)"</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Insufficient Facebook reaction data for actor analysis.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-fingerprint-actor-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparative-emotional-profiles" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="comparative-emotional-profiles"><span class="header-section-number">3.3</span> Comparative Emotional Profiles</h2>
<p>The heatmap provides a comparative view of emotional profiles across all actor types, making it easy to identify which actors receive similar or different emotional responses.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"actor_emotions"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(actor_emotions) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  actor_emotions_matrix <span class="ot">&lt;-</span> actor_emotions <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ACTOR_TYPE, LOVE, WOW, HAHA, SAD, ANGRY) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>ACTOR_TYPE, <span class="at">names_to =</span> <span class="st">"Emotion"</span>, <span class="at">values_to =</span> <span class="st">"Share"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(actor_emotions_matrix, <span class="fu">aes</span>(<span class="at">x =</span> Emotion, <span class="at">y =</span> ACTOR_TYPE, <span class="at">fill =</span> Share)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Share)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Emotional Profile Heatmap by Actor Type"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean share of each reaction type"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Share %"</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-heatmap-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="love-ratio-analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="love-ratio-analysis"><span class="header-section-number">3.4</span> LOVE Ratio Analysis</h2>
<p>LOVE reactions indicate deep appreciation and emotional connection. High LOVE share suggests content that resonates strongly with audience values and emotions.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  love_by_actor <span class="ot">&lt;-</span> fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Love_Share =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Love_Share =</span> <span class="fu">median</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Love_Share =</span> <span class="fu">sd</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> ACTOR_TYPE][<span class="fu">order</span>(<span class="sc">-</span>Mean_Love_Share)]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(love_by_actor, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ACTOR_TYPE, Mean_Love_Share), </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> Mean_Love_Share, <span class="at">fill =</span> ACTOR_TYPE)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean_Love_Share <span class="sc">-</span> SD_Love_Share<span class="sc">/</span><span class="fu">sqrt</span>(Posts),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> Mean_Love_Share <span class="sc">+</span> SD_Love_Share<span class="sc">/</span><span class="fu">sqrt</span>(Posts)),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Mean_Love_Share)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> actor_colors) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"LOVE Reaction Share by Actor Type"</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean percentage of LOVE among all emotional reactions (with standard error)"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"LOVE Share (%)"</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/love-ratio-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="angry-ratio-analysis" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="angry-ratio-analysis"><span class="header-section-number">3.5</span> ANGRY Ratio Analysis</h2>
<p>ANGRY reactions signal disagreement, outrage, or frustration. High ANGRY share may indicate controversial content, provocative framing, or topics that elicit strong negative responses.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  angry_by_actor <span class="ot">&lt;-</span> fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Angry_Share =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Angry_Share =</span> <span class="fu">median</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Angry_Share =</span> <span class="fu">sd</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> ACTOR_TYPE][<span class="fu">order</span>(<span class="sc">-</span>Mean_Angry_Share)]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(angry_by_actor, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ACTOR_TYPE, Mean_Angry_Share), </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> Mean_Angry_Share, <span class="at">fill =</span> ACTOR_TYPE)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, Mean_Angry_Share <span class="sc">-</span> SD_Angry_Share<span class="sc">/</span><span class="fu">sqrt</span>(Posts)),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> Mean_Angry_Share <span class="sc">+</span> SD_Angry_Share<span class="sc">/</span><span class="fu">sqrt</span>(Posts)),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Mean_Angry_Share)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> actor_colors) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"ANGRY Reaction Share by Actor Type"</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean percentage of ANGRY among all emotional reactions (with standard error)"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"ANGRY Share (%)"</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/angry-ratio-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="emotional-profile-table" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="emotional-profile-table"><span class="header-section-number">3.6</span> Emotional Profile Table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"actor_emotions"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(actor_emotions) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  actor_emotions <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Posts =</span> <span class="fu">format</span>(Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">LOVE =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, LOVE),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">WOW =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, WOW),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">HAHA =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, HAHA),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">SAD =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, SAD),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ANGRY =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, ANGRY)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, LOVE)))) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actor Type"</span>, <span class="st">"LOVE"</span>, <span class="st">"WOW"</span>, <span class="st">"HAHA"</span>, <span class="st">"SAD"</span>, <span class="st">"ANGRY"</span>, <span class="st">"Posts"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actor Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LOVE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">WOW</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HAHA</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SAD</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ANGRY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Posts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">100.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">99.8%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.2%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">75.1%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">24.9%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">62.8%</td>
<td style="text-align: left;">2.0%</td>
<td style="text-align: left;">9.2%</td>
<td style="text-align: left;">20.5%</td>
<td style="text-align: left;">5.5%</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">42.9%</td>
<td style="text-align: left;">2.7%</td>
<td style="text-align: left;">25.8%</td>
<td style="text-align: left;">12.9%</td>
<td style="text-align: left;">15.8%</td>
<td style="text-align: left;">137</td>
</tr>
<tr class="even">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">50.0%</td>
<td style="text-align: left;">16.7%</td>
<td style="text-align: left;">0.0%</td>
<td style="text-align: left;">33.3%</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="analysis-3.3-controversy-detection" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Analysis 3.3: Controversy Detection</h1>
<p>Controversy is operationalized through the <strong>Controversy Index</strong>, which combines the intensity of angry reactions with the visibility of the content.</p>
<p><strong>Formula:</strong> <code>Controversy Index = (ANGRY_COUNT / INTERACTIONS) × log(INTERACTIONS + 1)</code></p>
<p>This formula ensures that: 1. Content with higher ANGRY ratios scores higher 2. Content with more total interactions (greater reach) scores higher 3. The logarithmic transformation prevents extremely viral posts from dominating</p>
<p>Posts above the 95th percentile threshold are flagged as <strong>controversial</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  fb_data[, Controversy_Index <span class="sc">:</span><span class="er">=</span> (<span class="fu">fifelse</span>(<span class="fu">is.na</span>(ANGRY_COUNT), <span class="dv">0</span>, ANGRY_COUNT) <span class="sc">/</span> (INTERACTIONS <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">log</span>(INTERACTIONS <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  controversy_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(fb_data<span class="sc">$</span>Controversy_Index, <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  fb_data[, Is_Controversial <span class="sc">:</span><span class="er">=</span> Controversy_Index <span class="sc">&gt;</span> controversy_threshold]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Controversy threshold (95th percentile):"</span>, <span class="fu">round</span>(controversy_threshold, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Controversial posts:"</span>, <span class="fu">sum</span>(fb_data<span class="sc">$</span>Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Controversy threshold (95th percentile): 0 
Controversial posts: 71 </code></pre>
</div>
</div>
<section id="controversy-index-distribution" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="controversy-index-distribution"><span class="header-section-number">4.1</span> Controversy Index Distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Controversy_Index <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(fb_data[Controversy_Index <span class="sc">&gt;</span> <span class="dv">0</span>], <span class="fu">aes</span>(<span class="at">x =</span> Controversy_Index)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#ef4444"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> controversy_threshold, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> controversy_threshold <span class="sc">*</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"95th percentile threshold</span><span class="sc">\n</span><span class="st">(%.3f)"</span>, controversy_threshold),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Controversy Index Distribution"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Controversy Index = (ANGRY / INTERACTIONS) x log(INTERACTIONS)"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Controversy Index (log scale)"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Number of Posts"</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/controversy-distribution-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="most-controversial-posts" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="most-controversial-posts"><span class="header-section-number">4.2</span> Most Controversial Posts</h2>
<details>
<summary>
<strong>Click to expand</strong> (Top 20 most controversial posts)
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  top_controversial <span class="ot">&lt;-</span> fb_data[<span class="fu">order</span>(<span class="sc">-</span>Controversy_Index)][<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">50</span>, <span class="fu">nrow</span>(fb_data)), .(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> .I,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    FROM,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    ACTOR_TYPE,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    DATE,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">TITLE_SHORT =</span> <span class="fu">substr</span>(TITLE, <span class="dv">1</span>, <span class="dv">60</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    INTERACTIONS,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    ANGRY_COUNT,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    Controversy_Index</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  )]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  top_controversial[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(top_controversial))] <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">INTERACTIONS =</span> <span class="fu">format</span>(INTERACTIONS, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Controversy_Index =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Controversy_Index)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Source"</span>, <span class="st">"Actor Type"</span>, <span class="st">"Date"</span>, <span class="st">"Title"</span>, </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Interactions"</span>, <span class="st">"ANGRY"</span>, <span class="st">"Index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Rank</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Source</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Actor Type</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Date</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Title</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Interactions</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">ANGRY</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">srednja.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-22</td>
<td style="text-align: left;">Fuchs se susreo s Bozanićem: Razgovarali o suradnji Ministar</td>
<td style="text-align: left;">118</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">1.687</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Index Vijesti</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-21</td>
<td style="text-align: left;">Nadbiskup Barišić: Nezgodno je sad otkazati krizme, kasnije</td>
<td style="text-align: left;">108</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">1.119</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">DNEVNIK.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-15</td>
<td style="text-align: left;">Za Provjereno progovorili bivši djelatnici ogulinskog Crveno</td>
<td style="text-align: left;">245</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">1.052</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Narod.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-16</td>
<td style="text-align: left;">Nadbiskup Uzinić: Dozvoljena su misna slavlja na kojima ima</td>
<td style="text-align: left;">11</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">1.035</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Index.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-22</td>
<td style="text-align: left;">Splitski nadbiskup: Preporučujemo odgodu krizmi. Župa: Ipak</td>
<td style="text-align: left;">117</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">1.011</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Net.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-22</td>
<td style="text-align: left;">Stožer želi odgodu krizmi i pričesti, nadbiskup se neda: 'Bi</td>
<td style="text-align: left;">324</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">0.997</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Nisam Vjernik</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-09-30</td>
<td style="text-align: left;">"Neće ništa loše čuti na vjeronauku" (Zvuči suludo, naravno,</td>
<td style="text-align: left;">74</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">0.979</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Jutarnji</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-22</td>
<td style="text-align: left;">Liječnici: ‘Zaustavite pričesti i krizme‘: Nadbiskup Barišić</td>
<td style="text-align: left;">624</td>
<td style="text-align: right;">92</td>
<td style="text-align: left;">0.948</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Index.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-05-02</td>
<td style="text-align: left;">Svećenik u Salima na župu objesio zastavu s ustaškim slogano</td>
<td style="text-align: left;">889</td>
<td style="text-align: right;">122</td>
<td style="text-align: left;">0.931</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Pokret za sekularnu Hrvatsku</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-25</td>
<td style="text-align: left;">Svećenik na misi koju je prenosila HTV spominjao "bradate sv</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0.896</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">Index.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-21</td>
<td style="text-align: left;">Nadbiskup Barišić: Nezgodno je sad otkazati krizme, kasnije</td>
<td style="text-align: left;">790</td>
<td style="text-align: right;">105</td>
<td style="text-align: left;">0.886</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">Slobodna Dalmacija</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-25</td>
<td style="text-align: left;">Sramota na ekranima: svećenik na misi koju je prenosila tele</td>
<td style="text-align: left;">902</td>
<td style="text-align: right;">111</td>
<td style="text-align: left;">0.837</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">Dalmatinski portal</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-22</td>
<td style="text-align: left;">KARIN: Zbog korone treba odgoditi krizme i pričesti</td>
<td style="text-align: left;">335</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">0.744</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">Jutarnji</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-30</td>
<td style="text-align: left;">U sutrašnjem izdanju Jutarnjeg lista čitajte : 👉 Doći ću ti: |</td>
<td style="text-align: left;">|</td>
<td style="text-align: right;">3|</td>
<td style="text-align: left;">.732 |</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">Index Vijesti</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-05-02</td>
<td style="text-align: left;">Svećenik u Salima na župu objesio zastavu s ustaškim slogano</td>
<td style="text-align: left;">153</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">0.720</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: left;">24sata</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-05-02</td>
<td style="text-align: left;">Pater je zazivao novi Bljesak; Branitelj: Ne dao Bog, ratove</td>
<td style="text-align: left;">264</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">0.695</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: left;">Dnevno.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-05-04</td>
<td style="text-align: left;">SKANDAL KOJI JE 'ZAPALIO' SUSJEDE! Poznati sportaš urinirao</td>
<td style="text-align: left;">83</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">0.686</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: left;">Bitno.net</td>
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">2021-04-16</td>
<td style="text-align: left;">Nadbiskup Uzinić u pismu svećenicima: Dozvoljena su sva misn</td>
<td style="text-align: left;">165</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">0.677</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: left;">Jutarnji</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2021-04-16</td>
<td style="text-align: left;">Svećenik s Dugog otoka u novom skandalu, sukobio se s vjerni</td>
<td style="text-align: left;">1,169</td>
<td style="text-align: right;">99</td>
<td style="text-align: left;">0.598</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: left;">PolitikaPlus</td>
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">2021-10-05</td>
<td style="text-align: left;">Na kraju, samo jedna opaska. Člankom 10. ovog Ugovora zajamč</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.597</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</details>
</section>
<section id="controversy-by-actor-type" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="controversy-by-actor-type"><span class="header-section-number">4.3</span> Controversy by Actor Type</h2>
<p>Which actor types produce the most controversial content on average?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  controversy_actor <span class="ot">&lt;-</span> fb_data[, .(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Controversy =</span> <span class="fu">mean</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Controversy =</span> <span class="fu">median</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Controversy =</span> <span class="fu">max</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Controversial_Posts =</span> <span class="fu">sum</span>(Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Posts =</span> .N,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Controversy_Rate =</span> <span class="fu">sum</span>(Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> .N <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> ACTOR_TYPE][<span class="fu">order</span>(<span class="sc">-</span>Mean_Controversy)]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(controversy_actor, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ACTOR_TYPE, Mean_Controversy), </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> Mean_Controversy, <span class="at">fill =</span> ACTOR_TYPE)) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Mean_Controversy)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> actor_colors) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Mean Controversy Index by Actor Type"</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Higher values indicate more controversial content on average"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Mean Controversy Index"</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/controversy-by-actor-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="controversy-rate-by-actor-type" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="controversy-rate-by-actor-type"><span class="header-section-number">4.4</span> Controversy Rate by Actor Type</h2>
<p>The controversy rate shows the percentage of posts from each actor type that exceed the 95th percentile controversy threshold.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"controversy_actor"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(controversy_actor) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(controversy_actor, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ACTOR_TYPE, Controversy_Rate), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> Controversy_Rate, <span class="at">fill =</span> ACTOR_TYPE)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Controversy_Rate)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> actor_colors) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Controversy Rate by Actor Type"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Percentage of posts exceeding 95th percentile controversy threshold"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Controversy Rate (%)"</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/controversy-rate-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="controversy-summary-table" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="controversy-summary-table"><span class="header-section-number">4.5</span> Controversy Summary Table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"controversy_actor"</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(controversy_actor) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  controversy_actor <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Posts =</span> <span class="fu">format</span>(Total_Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Controversial_Posts =</span> <span class="fu">format</span>(Controversial_Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Controversy =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Mean_Controversy),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Median_Controversy =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Median_Controversy),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Controversy =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Max_Controversy),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">Controversy_Rate =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Controversy_Rate)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ACTOR_TYPE, Total_Posts, Controversial_Posts, Controversy_Rate, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>           Mean_Controversy, Median_Controversy, Max_Controversy) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actor Type"</span>, <span class="st">"Total Posts"</span>, <span class="st">"Controversial Posts"</span>, </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Controversy Rate"</span>, <span class="st">"Mean Index"</span>, <span class="st">"Median Index"</span>, <span class="st">"Max Index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actor Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Posts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Controversial Posts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Controversy Rate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean Index</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Median Index</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max Index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">42,121</td>
<td style="text-align: left;">63</td>
<td style="text-align: left;">0.15%</td>
<td style="text-align: left;">0.0006</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">1.687</td>
</tr>
<tr class="even">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">5,336</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">0.13%</td>
<td style="text-align: left;">0.0003</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.677</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">3,525</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.03%</td>
<td style="text-align: left;">0.0002</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.597</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">2,820</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.00%</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">9,800</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.00%</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">190</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.00%</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Youth Organizations</td>
<td style="text-align: left;">51</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.00%</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.0000</td>
<td style="text-align: left;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="controversy-over-time" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="controversy-over-time"><span class="header-section-number">4.6</span> Controversy Over Time</h2>
<p>Tracking controversy over time can reveal periods of heightened conflict or tension in the Catholic digital space.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  controversy_time <span class="ot">&lt;-</span> fb_data[, .(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Controversy =</span> <span class="fu">mean</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Controversial_Posts =</span> <span class="fu">sum</span>(Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Posts =</span> .N</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> .(<span class="at">Year =</span> <span class="fu">year</span>(DATE), <span class="at">Month =</span> <span class="fu">month</span>(DATE))]</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  controversy_time[, Date <span class="sc">:</span><span class="er">=</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>))]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  controversy_time[, Controversy_Rate <span class="sc">:</span><span class="er">=</span> Controversial_Posts <span class="sc">/</span> Total_Posts <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(controversy_time[<span class="sc">!</span><span class="fu">is.na</span>(Date)], <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Mean_Controversy)) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#ef4444"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%Y-%m"</span>, <span class="at">date_breaks =</span> <span class="st">"6 months"</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Controversy Index Over Time"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Monthly mean controversy index with LOESS trend"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Mean Controversy Index"</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/controversy-temporal-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="top-controversial-sources" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="top-controversial-sources"><span class="header-section-number">4.7</span> Top Controversial Sources</h2>
<details>
<summary>
<strong>Click to expand</strong> (Sources with highest mean controversy, minimum 20 posts)
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  source_controversy <span class="ot">&lt;-</span> fb_data[, .(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Controversy =</span> <span class="fu">mean</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Controversy =</span> <span class="fu">max</span>(Controversy_Index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Controversial_Posts =</span> <span class="fu">sum</span>(Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Posts =</span> .N,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_ANGRY =</span> <span class="fu">sum</span>(ANGRY_COUNT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ACTOR_TYPE =</span> <span class="fu">first</span>(ACTOR_TYPE)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> FROM][Total_Posts <span class="sc">&gt;=</span> <span class="dv">20</span>][<span class="fu">order</span>(<span class="sc">-</span>Mean_Controversy)]</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(source_controversy) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    source_controversy[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(source_controversy))] <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">Total_Posts =</span> <span class="fu">format</span>(Total_Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">Total_ANGRY =</span> <span class="fu">format</span>(Total_ANGRY, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">Mean_Controversy =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Mean_Controversy),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">Max_Controversy =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Max_Controversy)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(FROM, ACTOR_TYPE, Total_Posts, Controversial_Posts, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>             Mean_Controversy, Max_Controversy, Total_ANGRY) <span class="sc">%&gt;%</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Actor Type"</span>, <span class="st">"Posts"</span>, <span class="st">"Controversial"</span>, </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Mean Index"</span>, <span class="st">"Max Index"</span>, <span class="st">"Total ANGRY"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Actor Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Posts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Controversial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean Index</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max Index</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total ANGRY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nisam Vjernik</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">22</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0445</td>
<td style="text-align: left;">0.979</td>
<td style="text-align: left;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Makarska Danas</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">31</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0.0187</td>
<td style="text-align: left;">0.409</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Index.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">293</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">0.0136</td>
<td style="text-align: left;">1.011</td>
<td style="text-align: left;">301</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jutarnji</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">262</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0.0104</td>
<td style="text-align: left;">0.948</td>
<td style="text-align: left;">207</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Index Vijesti</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">240</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.0077</td>
<td style="text-align: left;">1.119</td>
<td style="text-align: left;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zoran Šprajc</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">22</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0035</td>
<td style="text-align: left;">0.077</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lupiga.com</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">47</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0034</td>
<td style="text-align: left;">0.160</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dalmatinski portal</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">239</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0031</td>
<td style="text-align: left;">0.744</td>
<td style="text-align: left;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">24sata</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">475</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0.0026</td>
<td style="text-align: left;">0.695</td>
<td style="text-align: left;">74</td>
</tr>
<tr class="even">
<td style="text-align: left;">Narod.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">465</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.0024</td>
<td style="text-align: left;">1.035</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slobodna Dalmacija</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">764</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0.0023</td>
<td style="text-align: left;">0.837</td>
<td style="text-align: left;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tportal.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">408</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0.0022</td>
<td style="text-align: left;">0.545</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">N1 Hrvatska</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">326</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0018</td>
<td style="text-align: left;">0.575</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Net.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">655</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.0017</td>
<td style="text-align: left;">0.997</td>
<td style="text-align: left;">59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DNEVNIK.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">643</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0016</td>
<td style="text-align: left;">1.052</td>
<td style="text-align: left;">47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dubrovački vjesnik</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">207</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0016</td>
<td style="text-align: left;">0.322</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dnevno.hr</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">620</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0.0015</td>
<td style="text-align: left;">0.686</td>
<td style="text-align: left;">66</td>
</tr>
<tr class="even">
<td style="text-align: left;">SNAGA Šibenski portal</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">54</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0013</td>
<td style="text-align: left;">0.072</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ŠibenikIN</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">459</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0010</td>
<td style="text-align: left;">0.456</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Croative.net</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">350</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0.0010</td>
<td style="text-align: left;">0.347</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</section>
</section>
<section id="analysis-3.4-emotion-by-sentiment" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analysis 3.4: Emotion by Sentiment</h1>
<p>This section cross-tabulates automated sentiment classification with actual emotional reactions to validate whether sentiment labels align with audience responses.</p>
<p><strong>Expected patterns:</strong> - Positive sentiment posts should receive more LOVE reactions - Negative sentiment posts should receive more ANGRY and SAD reactions - Neutral sentiment posts should show balanced emotional profiles</p>
<p>Deviations from these patterns may indicate limitations in the sentiment classifier or interesting disconnects between content tone and audience reception.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  emotion_sentiment <span class="ot">&lt;-</span> fb_data[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT) <span class="sc">&amp;</span> Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">WOW =</span> <span class="fu">mean</span>(WOW_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">HAHA =</span> <span class="fu">mean</span>(HAHA_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAD =</span> <span class="fu">mean</span>(SAD_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> AUTO_SENTIMENT]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  emotion_sentiment_long <span class="ot">&lt;-</span> emotion_sentiment <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Posts) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>AUTO_SENTIMENT, <span class="at">names_to =</span> <span class="st">"Emotion"</span>, <span class="at">values_to =</span> <span class="st">"Share"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emotion_sentiment_long, <span class="fu">aes</span>(<span class="at">x =</span> Emotion, <span class="at">y =</span> Share, <span class="at">fill =</span> Emotion)) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>AUTO_SENTIMENT, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> emotion_colors) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Emotional Reactions by Automated Sentiment"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean reaction share within each sentiment category"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Share of Emotional Reactions (%)"</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-sentiment-cross-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="sentiment-validation-through-reactions" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sentiment-validation-through-reactions"><span class="header-section-number">5.1</span> Sentiment Validation Through Reactions</h2>
<p>The <strong>Positive Ratio</strong> divides LOVE by (ANGRY + SAD) to measure whether sentiment classifications align with actual emotional responses. Higher ratios for positive sentiment validate the classifier.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  validation_metrics <span class="ot">&lt;-</span> fb_data[<span class="sc">!</span><span class="fu">is.na</span>(AUTO_SENTIMENT) <span class="sc">&amp;</span> Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Love =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Angry =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Sad =</span> <span class="fu">mean</span>(SAD_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Positive_Ratio =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">mean</span>(SAD_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fl">0.001</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> AUTO_SENTIMENT]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  validation_metrics <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Love =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Mean_Love <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Angry =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Mean_Angry <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Sad =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Mean_Sad <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Positive_Ratio =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, Positive_Ratio)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Auto Sentiment"</span>, <span class="st">"Mean LOVE"</span>, <span class="st">"Mean ANGRY"</span>, <span class="st">"Mean SAD"</span>, </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Positive Ratio (LOVE / (ANGRY+SAD))"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Auto Sentiment</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean LOVE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean ANGRY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean SAD</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Positive Ratio (LOVE / (ANGRY+SAD))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">negative</td>
<td style="text-align: left;">35.2%</td>
<td style="text-align: left;">17.9%</td>
<td style="text-align: left;">17.7%</td>
<td style="text-align: left;">0.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">positive</td>
<td style="text-align: left;">90.7%</td>
<td style="text-align: left;">1.4%</td>
<td style="text-align: left;">1.3%</td>
<td style="text-align: left;">32.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">neutral</td>
<td style="text-align: left;">50.0%</td>
<td style="text-align: left;">10.9%</td>
<td style="text-align: left;">16.1%</td>
<td style="text-align: left;">1.85</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="analysis-3.5-emotional-temporal-patterns" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Analysis 3.5: Emotional Temporal Patterns</h1>
<p>Emotional patterns may vary over time due to seasonal factors (liturgical calendar), events (elections, scandals), or longer term trends in the Catholic digital space.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  emotion_monthly <span class="ot">&lt;-</span> fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, .(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAD =</span> <span class="fu">mean</span>(SAD_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> .(<span class="at">Year =</span> <span class="fu">year</span>(DATE), <span class="at">Month =</span> <span class="fu">month</span>(DATE))]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  emotion_monthly[, Date <span class="sc">:</span><span class="er">=</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>))]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  emotion_monthly_long <span class="ot">&lt;-</span> emotion_monthly <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Date, LOVE, ANGRY, SAD) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"Emotion"</span>, <span class="at">values_to =</span> <span class="st">"Share"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emotion_monthly_long[<span class="sc">!</span><span class="fu">is.na</span>(Date)], <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Share, <span class="at">color =</span> Emotion)) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"LOVE"</span> <span class="ot">=</span> <span class="st">"#ec4899"</span>, <span class="st">"ANGRY"</span> <span class="ot">=</span> <span class="st">"#ef4444"</span>, <span class="st">"SAD"</span> <span class="ot">=</span> <span class="st">"#3b82f6"</span>)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%Y-%m"</span>, <span class="at">date_breaks =</span> <span class="st">"6 months"</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Key Emotional Reactions Over Time"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Monthly mean share of LOVE, ANGRY, and SAD reactions"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Share of Emotional Reactions (%)"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Reaction"</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-temporal-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="day-of-week-emotional-patterns" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="day-of-week-emotional-patterns"><span class="header-section-number">6.1</span> Day of Week Emotional Patterns</h2>
<p>Do posting patterns by day of week affect emotional responses? Sunday posts (liturgical content) may receive different reactions than weekday posts.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(fb_data) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(fb_data<span class="sc">$</span>Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  fb_data[, DOW <span class="sc">:</span><span class="er">=</span> lubridate<span class="sc">::</span><span class="fu">wday</span>(DATE, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  emotion_dow <span class="ot">&lt;-</span> fb_data[Total_Reactions <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(DOW), .(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">LOVE =</span> <span class="fu">mean</span>(LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ANGRY =</span> <span class="fu">mean</span>(ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> .N</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  ), by <span class="ot">=</span> DOW]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  emotion_dow_long <span class="ot">&lt;-</span> emotion_dow <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(DOW, LOVE, ANGRY) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>DOW, <span class="at">names_to =</span> <span class="st">"Emotion"</span>, <span class="at">values_to =</span> <span class="st">"Share"</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(emotion_dow_long, <span class="fu">aes</span>(<span class="at">x =</span> DOW, <span class="at">y =</span> Share, <span class="at">fill =</span> Emotion)) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"LOVE"</span> <span class="ot">=</span> <span class="st">"#ec4899"</span>, <span class="st">"ANGRY"</span> <span class="ot">=</span> <span class="st">"#ef4444"</span>)) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"LOVE and ANGRY Reactions by Day of Week"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Mean share of reactions by posting day"</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Share of Emotional Reactions (%)"</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Reaction"</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="map_3_emotional_files/figure-html/emotion-dayofweek-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary-and-key-findings" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Summary and Key Findings</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>total_with_sentiment <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(dta<span class="sc">$</span>AUTO_SENTIMENT))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>positive_pct <span class="ot">&lt;-</span> <span class="fu">sum</span>(dta<span class="sc">$</span>AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"positive"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_with_sentiment <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>negative_pct <span class="ot">&lt;-</span> <span class="fu">sum</span>(dta<span class="sc">$</span>AUTO_SENTIMENT <span class="sc">==</span> <span class="st">"negative"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_with_sentiment <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>fb_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fb_data)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>mean_love_share <span class="ot">&lt;-</span> <span class="cf">if</span>(fb_total <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">mean</span>(fb_data<span class="sc">$</span>LOVE_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>mean_angry_share <span class="ot">&lt;-</span> <span class="cf">if</span>(fb_total <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">mean</span>(fb_data<span class="sc">$</span>ANGRY_SHARE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>controversial_count <span class="ot">&lt;-</span> <span class="cf">if</span>(fb_total <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">sum</span>(fb_data<span class="sc">$</span>Is_Controversial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="cf">else</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="summary-table" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="summary-table"><span class="header-section-number">7.1</span> Summary Table</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Finding =</span> <span class="fu">c</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Total posts with sentiment data"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Positive sentiment share"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Negative sentiment share"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Facebook posts with reaction data"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean LOVE share of reactions"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean ANGRY share of reactions"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Posts exceeding controversy threshold"</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(total_with_sentiment, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, positive_pct),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, negative_pct),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(fb_total, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, mean_love_share),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, mean_angry_share),</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(controversial_count, <span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Finding"</span>, <span class="st">"Value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Finding</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total posts with sentiment data</td>
<td style="text-align: left;">608,879</td>
</tr>
<tr class="even">
<td style="text-align: left;">Positive sentiment share</td>
<td style="text-align: left;">47.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negative sentiment share</td>
<td style="text-align: left;">28.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Facebook posts with reaction data</td>
<td style="text-align: left;">63,843</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean LOVE share of reactions</td>
<td style="text-align: left;">53.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean ANGRY share of reactions</td>
<td style="text-align: left;">11.95%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posts exceeding controversy threshold</td>
<td style="text-align: left;">71</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="hypotheses-testing-summary" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="hypotheses-testing-summary"><span class="header-section-number">7.2</span> Hypotheses Testing Summary</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 47%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Hypothesis</th>
<th>Metric to Examine</th>
<th>Finding</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H10: Catholic digital content is predominantly positive</td>
<td>Sentiment distribution, positivity ratio</td>
<td>See overall sentiment distribution</td>
</tr>
<tr class="even">
<td>H11: Lay influencers have highest LOVE ratios</td>
<td>LOVE share by actor type</td>
<td>Compare actor emotional fingerprints</td>
</tr>
<tr class="odd">
<td>H12: Independent media generates most controversy</td>
<td>Controversy rate by actor type</td>
<td>Compare controversy rates</td>
</tr>
<tr class="even">
<td>H13: Negative sentiment correlates with higher engagement</td>
<td>Sentiment-engagement relationship</td>
<td>See sentiment-engagement analysis</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="appendix-classification-quality-diagnostics" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Appendix: Classification Quality Diagnostics</h1>
<details>
<summary>
<strong>Click to expand diagnostics</strong> (Quality assurance for actor classification)
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Actor type distribution check</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>actor_dist <span class="ot">&lt;-</span> dta[, .(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Posts =</span> .N,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sources =</span> <span class="fu">uniqueN</span>(FROM),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_Interactions =</span> <span class="fu">mean</span>(INTERACTIONS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> ACTOR_TYPE][<span class="fu">order</span>(<span class="sc">-</span>Posts)]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>actor_dist <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> <span class="fu">format</span>(Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sources =</span> <span class="fu">format</span>(Sources, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Interactions =</span> <span class="fu">round</span>(Mean_Interactions, <span class="dv">1</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actor Type"</span>, <span class="st">"Posts"</span>, <span class="st">"Sources"</span>, <span class="st">"Mean Interactions"</span>),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Actor Type Distribution in Emotional Analysis Sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Actor Type Distribution in Emotional Analysis Sample</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actor Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Posts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sources</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">468,760</td>
<td style="text-align: left;">16,076</td>
<td style="text-align: right;">99.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Institutional Official</td>
<td style="text-align: left;">62,744</td>
<td style="text-align: left;">202</td>
<td style="text-align: right;">56.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent Media</td>
<td style="text-align: left;">31,401</td>
<td style="text-align: left;">18</td>
<td style="text-align: right;">210.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lay Influencers</td>
<td style="text-align: left;">28,451</td>
<td style="text-align: left;">62</td>
<td style="text-align: right;">224.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diocesan</td>
<td style="text-align: left;">13,841</td>
<td style="text-align: left;">50</td>
<td style="text-align: right;">46.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Religious Orders</td>
<td style="text-align: left;">1,677</td>
<td style="text-align: left;">11</td>
<td style="text-align: right;">22.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Charismatic Communities</td>
<td style="text-align: left;">1,282</td>
<td style="text-align: left;">12</td>
<td style="text-align: right;">153.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">671</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">17.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Youth Organizations</td>
<td style="text-align: left;">52</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">128.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check high-engagement sources in Other category</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>other_high_engagement <span class="ot">&lt;-</span> dta[ACTOR_TYPE <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">&amp;</span> SOURCE_TYPE <span class="sc">==</span> <span class="st">"facebook"</span>, .(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Posts =</span> .N,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_Interactions =</span> <span class="fu">sum</span>(INTERACTIONS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>), by <span class="ot">=</span> FROM][<span class="fu">order</span>(<span class="sc">-</span>Total_Interactions)][<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>other_high_engagement <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posts =</span> <span class="fu">format</span>(Posts, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Interactions =</span> <span class="fu">format</span>(Total_Interactions, <span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Source"</span>, <span class="st">"Posts"</span>, <span class="st">"Total Interactions"</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Top Facebook Sources in 'Other' Category (review for misclassification)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top Facebook Sources in 'Other' Category (review for misclassification)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Posts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Index.hr</td>
<td style="text-align: left;">294</td>
<td style="text-align: left;">197,104</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gospa</td>
<td style="text-align: left;">624</td>
<td style="text-align: left;">179,812</td>
</tr>
<tr class="odd">
<td style="text-align: left;">24sata</td>
<td style="text-align: left;">482</td>
<td style="text-align: left;">174,369</td>
</tr>
<tr class="even">
<td style="text-align: left;">DNEVNIK.hr</td>
<td style="text-align: left;">648</td>
<td style="text-align: left;">164,778</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RTL Danas</td>
<td style="text-align: left;">663</td>
<td style="text-align: left;">158,676</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kraljica Mira</td>
<td style="text-align: left;">1,224</td>
<td style="text-align: left;">155,621</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Velimir Bujanec</td>
<td style="text-align: left;">114</td>
<td style="text-align: left;">144,769</td>
</tr>
<tr class="even">
<td style="text-align: left;">Net.hr</td>
<td style="text-align: left;">664</td>
<td style="text-align: left;">135,958</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RTL Direkt</td>
<td style="text-align: left;">157</td>
<td style="text-align: left;">135,282</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marko Perković Thompson</td>
<td style="text-align: left;">28</td>
<td style="text-align: left;">124,277</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Slobodna Dalmacija</td>
<td style="text-align: left;">774</td>
<td style="text-align: left;">118,415</td>
</tr>
<tr class="even">
<td style="text-align: left;">Večernji list</td>
<td style="text-align: left;">560</td>
<td style="text-align: left;">115,060</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Telegram.hr</td>
<td style="text-align: left;">260</td>
<td style="text-align: left;">111,267</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ivan Pokupec</td>
<td style="text-align: left;">120</td>
<td style="text-align: left;">108,174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HRT Vijesti</td>
<td style="text-align: left;">180</td>
<td style="text-align: left;">106,376</td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<hr>
</section>
<section id="appendix-model-diagnostics" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Appendix: Model Diagnostics</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Emotional Analysis Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Emotional Analysis Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total posts:"</span>, <span class="fu">nrow</span>(dta), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total posts: 608879 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Posts with sentiment:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(dta<span class="sc">$</span>AUTO_SENTIMENT)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Posts with sentiment: 608879 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Facebook posts with reactions:"</span>, <span class="fu">nrow</span>(fb_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Facebook posts with reactions: 63843 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Date range:"</span>, <span class="fu">as.character</span>(<span class="fu">min</span>(dta<span class="sc">$</span>DATE)), <span class="st">"to"</span>, <span class="fu">as.character</span>(<span class="fu">max</span>(dta<span class="sc">$</span>DATE)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Date range: 2021-01-01 to 2025-12-31 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=Croatian_Croatia.utf8  LC_CTYPE=Croatian_Croatia.utf8   
[3] LC_MONETARY=Croatian_Croatia.utf8 LC_NUMERIC=C                     
[5] LC_TIME=Croatian_Croatia.utf8    

time zone: Europe/Zagreb
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.3.2   ggridges_0.5.7    viridis_0.6.5     viridisLite_0.4.2
 [5] fmsb_0.7.6        kableExtra_1.4.0  knitr_1.50        scales_1.4.0     
 [9] data.table_1.17.8 lubridate_1.9.4   forcats_1.0.1     stringr_1.6.0    
[13] dplyr_1.1.4       purrr_1.2.0       readr_2.1.6       tidyr_1.3.1      
[17] tibble_3.3.0      ggplot2_4.0.1     tidyverse_2.0.0  

loaded via a namespace (and not attached):
 [1] generics_0.1.4     xml2_1.5.1         lattice_0.22-7     stringi_1.8.7     
 [5] hms_1.1.4          digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5    
 [9] grid_4.5.2         timechange_0.3.0   RColorBrewer_1.1-3 fastmap_1.2.0     
[13] Matrix_1.7-4       jsonlite_2.0.0     gridExtra_2.3      mgcv_1.9-3        
[17] textshaping_1.0.4  cli_3.6.5          rlang_1.1.6        splines_4.5.2     
[21] withr_3.0.2        yaml_2.3.11        tools_4.5.2        tzdb_0.5.0        
[25] vctrs_0.6.5        R6_2.6.1           lifecycle_1.0.4    htmlwidgets_1.6.4 
[29] pkgconfig_2.0.3    pillar_1.11.1      gtable_0.3.6       glue_1.8.0        
[33] systemfonts_1.3.1  xfun_0.54          tidyselect_1.2.1   rstudioapi_0.17.1 
[37] dichromat_2.0-0.1  farver_2.1.2       nlme_3.1-168       htmltools_0.5.8.1 
[41] labeling_0.4.3     rmarkdown_2.30     svglite_2.2.2      compiler_4.5.2    
[45] S7_0.2.1          </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>